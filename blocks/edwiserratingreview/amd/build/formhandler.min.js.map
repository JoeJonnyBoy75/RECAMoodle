{"version":3,"file":"formhandler.min.js","sources":["../src/formhandler.js"],"sourcesContent":["/* eslint-disable no-alert */\n/* eslint-disable no-console */\n/* eslint-disable no-unused-vars */\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/templates',\n    'core/notification',\n    'block_edwiserratingreview/reviewfilter'\n    ], function ($, Ajax, Templates, Notification, Reviewfilter) {\n\n    const SELECTORS = {\n        FEEDBACKFORM: '.feedbackform',\n        FORMCONTAINER: '.feedbackform-container',\n        WRITEREVIEWBTN: '.writereviewbtn',\n        FEEDBACKFORM_RESPONSE: '.feedbacksubmitresponse',\n        RATINGSELECTION: '.ratingselectionalert',\n        FEEDBACKFORMDATA: '#feedbackformdata',\n        STARINPUT: \".rating-stars-input input[name='rating']\",\n        SUBMITREVIEW: '.submitreview',\n        CANCELREVIEW: '.cancelreview'\n    };\n\n    const eventListeners = () => {\n        $(document).off().on(\"click\", SELECTORS.SUBMITREVIEW, function (e) {\n            e.preventDefault();\n\n            var rating = $('input[name=\"rating\"]:checked').val();\n            var review = $('[name=\"review\"]').val();\n\n            Ajax.call([{\n                methodname: 'block_edwiserratingreview_store_userfeedback',\n                args: {\n                    starcount: rating,\n                    contextid: M.cfg.contextid,\n                    feedbackreview: review,\n                    fortype: \"course\"\n                },\n                done: function () {\n                    $(SELECTORS.FEEDBACKFORM).remove();\n                    $(SELECTORS.WRITEREVIEWBTN).show().removeAttr(\"disabled\");\n                    $(SELECTORS.FORMCONTAINER).empty().append(datasubmittionalert);\n                    // Reviewfilter.init(); // uncomment this to update the reviews area.\n                },\n                fail: function () {\n                    console.log(Notification.exception);\n                }\n\n            }]);\n        });\n\n        // eslint-disable-next-line max-len\n        var datasubmittionalert = `<div class=\"alert alert-warning alert-dismissible fade show\" role=\"alert\" style=\"margin-top:10px;\" >\n        Thank you for submitting the review. Your review will be published soon.\n            <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">\n             <span aria-hidden=\"true\">&times;</span>\n            </button>\n        </div>`;\n        // style=\"background-color: #f0ad4e;\"\n        $(document).on(\"click\", SELECTORS.STARINPUT, function () {\n            $(SELECTORS.SUBMITREVIEW).removeAttr(\"disabled\");\n        });\n\n        $(document).on(\"click\", SELECTORS.CANCELREVIEW, function() {\n            $(SELECTORS.FEEDBACKFORM).remove();\n            $(SELECTORS.WRITEREVIEWBTN).show().removeAttr(\"disabled\");\n        });\n\n        $(SELECTORS.WRITEREVIEWBTN).off().click(function(){\n            $(SELECTORS.WRITEREVIEWBTN).attr(\"disabled\", true);\n            Ajax.call([{\n                methodname: 'block_edwiserratingreview_get_review',\n                args: {\n                    contextid: M.cfg.contextid,\n                },\n                done: function (data) {\n                    Templates.render('block_edwiserratingreview/feedbackform', data.data)\n                    .done(function (html, js) {\n                        Templates.replaceNodeContents($(SELECTORS.FORMCONTAINER), html, js);\n                        $(\"#rate-\" + data.data.star_ratings).click();\n                    });\n\n                    $(SELECTORS.WRITEREVIEWBTN).hide();\n                },\n                fail: function () {\n                    console.log(Notification.exception);\n                }\n            }]);\n\n        });\n    };\n\n    var init = function () {\n        eventListeners();\n    };\n\n    return {\n        init: init,\n    };\n});\n"],"names":["define","$","Ajax","Templates","Notification","Reviewfilter","SELECTORS","init","document","off","on","e","preventDefault","rating","val","review","call","methodname","args","starcount","contextid","M","cfg","feedbackreview","fortype","done","remove","show","removeAttr","empty","append","datasubmittionalert","fail","console","log","exception","click","attr","data","render","html","js","replaceNodeContents","star_ratings","hide","eventListeners"],"mappings":"AAGAA,+CAAO,CACH,SACA,YACA,iBACA,oBACA,2CACG,SAAUC,EAAGC,KAAMC,UAAWC,aAAcC,oBAEzCC,uBACY,gBADZA,wBAEa,0BAFbA,yBAGc,kBAHdA,oBAOS,2CAPTA,uBAQY,gBARZA,uBASY,sBA4EX,CACHC,KALO,WArEY,MACnBN,EAAEO,UAAUC,MAAMC,GAAG,QAASJ,wBAAwB,SAAUK,GAC5DA,EAAEC,qBAEEC,OAASZ,EAAE,gCAAgCa,MAC3CC,OAASd,EAAE,mBAAmBa,MAElCZ,KAAKc,KAAK,CAAC,CACPC,WAAY,+CACZC,KAAM,CACFC,UAAWN,OACXO,UAAWC,EAAEC,IAAIF,UACjBG,eAAgBR,OAChBS,QAAS,UAEbC,KAAM,WACFxB,EAAEK,wBAAwBoB,SAC1BzB,EAAEK,0BAA0BqB,OAAOC,WAAW,YAC9C3B,EAAEK,yBAAyBuB,QAAQC,OAAOC,sBAG9CC,KAAM,WACFC,QAAQC,IAAI9B,aAAa+B,sBAOjCJ,oYAOJ9B,EAAEO,UAAUE,GAAG,QAASJ,qBAAqB,WACzCL,EAAEK,wBAAwBsB,WAAW,eAGzC3B,EAAEO,UAAUE,GAAG,QAASJ,wBAAwB,WAC5CL,EAAEK,wBAAwBoB,SAC1BzB,EAAEK,0BAA0BqB,OAAOC,WAAW,eAGlD3B,EAAEK,0BAA0BG,MAAM2B,OAAM,WACpCnC,EAAEK,0BAA0B+B,KAAK,YAAY,GAC7CnC,KAAKc,KAAK,CAAC,CACPC,WAAY,uCACZC,KAAM,CACFE,UAAWC,EAAEC,IAAIF,WAErBK,KAAM,SAAUa,MACZnC,UAAUoC,OAAO,yCAA0CD,KAAKA,MAC/Db,MAAK,SAAUe,KAAMC,IAClBtC,UAAUuC,oBAAoBzC,EAAEK,yBAA0BkC,KAAMC,IAChExC,EAAE,SAAWqC,KAAKA,KAAKK,cAAcP,WAGzCnC,EAAEK,0BAA0BsC,QAEhCZ,KAAM,WACFC,QAAQC,IAAI9B,aAAa+B,mBAQrCU"}