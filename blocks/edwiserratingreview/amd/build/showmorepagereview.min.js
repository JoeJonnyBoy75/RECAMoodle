define("block_edwiserratingreview/showmorepagereview",["jquery","core/ajax","core/notification","core/templates","block_edwiserratingreview/reviewfilter"],(function($,Ajax,Notification){var isModified=!1,rating=0,coursecontext="",SELECTORS_MAINPAGEREVIEW=".mainpagereview",SELECTORS_SHOWMOREPAGECOURSEMENU=".ernr_showmorepagecoursemenu",init=function(value,start,limit,contextid){coursecontext=contextid,Ajax.call([{methodname:"block_edwiserratingreview_show_review",args:{rating:value,startlimit:start,lastlimit:limit,contextid:coursecontext},done:function(data){1==isModified?replaceData(data):appendData(data),rating=value},fail:function(){console.log(Notification.exception)}}])},appendData=function(data){$(SELECTORS_MAINPAGEREVIEW).append(data)},replaceData=function(data){""==data?$(SELECTORS_MAINPAGEREVIEW).empty().append("No Review Found"):$(SELECTORS_MAINPAGEREVIEW).empty().append(data)};return{init:function(value,start,limit,coursecontext){$(document).ready((function(){init(value,start,limit,coursecontext),function(coursecontext){console.log("get courselist"),Ajax.call([{methodname:"block_edwiserratingreview_getcourselist",args:{coursecontext:coursecontext},done:function(data){$(SELECTORS_SHOWMOREPAGECOURSEMENU).empty().append(data)},fail:function(){console.log(Notification.exception)}}])}(coursecontext),$(".showmorepagereviewselector option[value='"+value+"']").attr("selected","selected"),$(".ernr_showmorepagecoursemenu option[value='"+coursecontext+"']").attr("selected","selected")})),$(window).on("scroll",(function(){var scrollHeight=$(document).height();(scrollHeight-($(window).height()+$(window).scrollTop()))/scrollHeight==0&&(start=$(SELECTORS_MAINPAGEREVIEW).attr("data-end"),$(SELECTORS_MAINPAGEREVIEW).attr("data-end",Number(start)+10),limit=$(SELECTORS_MAINPAGEREVIEW).attr("data-end"),start=Number(start)+1,isModified=!1,init(rating,start,limit,coursecontext),console.log("data lazy loaded"))})),$("#page").on("scroll",(function(){$(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight&&(start=$(SELECTORS_MAINPAGEREVIEW).attr("data-end"),$(SELECTORS_MAINPAGEREVIEW).attr("data-end",Number(start)+10),limit=$(SELECTORS_MAINPAGEREVIEW).attr("data-end"),start=Number(start)+1,isModified=!1,init(rating,start,limit,coursecontext),console.log("data lazy loaded"))})),$(".showmorepagereviewselector").change((function(){rating=$(".showmorepagereviewselector option:selected").attr("value"),isModified=!0,init(rating,0,10,coursecontext)})),$(document).on("change",".ernr_showmorepagecoursemenu",(function(){rating=$(".showmorepagereviewselector option:selected").attr("value"),coursecontext=$(".ernr_showmorepagecoursemenu option:selected").attr("value"),console.log("course item selected"),console.log(coursecontext),isModified=!0,init(rating,0,10,coursecontext)}))}}}));

//# sourceMappingURL=showmorepagereview.min.js.map