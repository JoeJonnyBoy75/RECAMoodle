define ("block_remuiblck/quizstats",["jquery","core/ajax","core/chartjs"],function(a,b){var c={ROOT:null,CHART:"#barChart",CHART_AREA:"#quiz-chart-area",COURSE_LIST:"#quiz-course-list",QUIZ_LIST:"#quiz-list",LIST_SELECTED:"option:selected",ERROR:".quiz-stats-error"},d=null,e=function(a){var b=0,c;a.forEach(function(a){c=Math.max.apply(Math,a.data);b=c>b?c:b});return Math.ceil(b/20)};function f(){var f=g(),i=h();b.call([{methodname:"block_remuiblck_get_quiz_participation",args:{courseid:f,quizid:i}}])[0].done(function(b){if(b.datasets===void 0){a(c.ROOT).find(c.CHART_AREA).hide();a(c.ROOT).find(c.ERROR).show()}else{if(null!==d){d.destroy()}var f=a(c.ROOT).find(c.CHART).get(0).getContext("2d");f.canvas.height=400;var g={labels:b.labels,datasets:b.datasets};d=new Chart(f,{type:"bar",data:g,options:{responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{scaleLabel:{display:!0,labelString:M.util.get_string("noofstudents","block_remuiblck")},ticks:{min:0,stepSize:e(b.datasets)}}]}}})}}).fail(function(){a(c.ROOT).find(c.CHART_AREA).hide();a(c.ROOT).find(c.ERROR).show()})}var g=function(){return a(c.ROOT).find(c.COURSE_LIST+" "+c.LIST_SELECTED).data("courseid")},h=function(){return a(c.ROOT).find(c.QUIZ_LIST+" "+c.LIST_SELECTED).data("quizid")},i=function(){var d=g();b.call([{methodname:"block_remuiblck_get_quizzes_of_course",args:{courseid:d}}])[0].done(function(b){for(var d="",e=0;e<b.length;e++){d=d+"<option data-id='"+b[e].courseid+"' data-quizid='"+b[e].quizid+"'>";d=d+b[e].quizname+"</option>"}a(c.ROOT).find(c.QUIZ_LIST).empty().append(d);f()}).fail(function(){a(c.ROOT).find(c.CHART_AREA).hide();a(c.ROOT).find(c.ERROR).show()})},j=function(){a(c.ROOT).find(c.COURSE_LIST).on("change",function(){i()});a(c.ROOT).find(c.QUIZ_LIST).on("change",function(){f()})};return{init:function init(b){c.ROOT=b;a(document).ready(function(){j();if(a(c.ROOT).find(c.CHART).length){f()}})}}});
//# sourceMappingURL=quizstats.min.js.map
