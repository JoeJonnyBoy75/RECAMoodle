{"version":3,"sources":["../src/manage_courses_filters.js"],"names":["define","$","CustomEvents","Notification","RemuiblckEvents","ManageCoursesView","SELECTORS","COURSES_LIST","DISPLAY_FILTER","FILTER_OPTION","PER_PAGE_FILTER","PAGINATE","NEXT","PREVIOUS","registerManageCourseDisplayFilter","root","manageCourseDisplayFilterContainer","find","events","activate","on","e","data","originalEvent","preventDefault","option","target","closest","hasClass","trigger","MANAGE_COURSES_DISPLAY_FILTER_CHANGE","M","util","set_user_preference","loadCourses","getManageCoursesPerPage","registerManageCoursePerPageFilter","manageCoursePerPageFilterContainer","MANAGE_COURSES_PAGE_FILTER_CHANGE","getManageCourseDisplay","registerManageCoursePageFilter","manageCoursePageFilterContainer","pagenumber","maxpage","is","MANAGE_COURSES_PAGINATE","init"],"mappings":"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","sourcesContent":["define([\n    'jquery',\n    'core/custom_interaction_events',\n    'core/notification',\n    'block_remuiblck/events',\n    'block_remuiblck/manage_courses_view'\n], function(\n    $,\n    CustomEvents,\n    Notification,\n    RemuiblckEvents,\n    ManageCoursesView\n) {\n    var SELECTORS = {\n        COURSES_LIST: '[data-region=\"manage-courses-list\"]',\n        DISPLAY_FILTER: '[data-region=\"manage-courses-display-filter\"]',\n        FILTER_OPTION: '[data-value]',\n        PER_PAGE_FILTER: '[data-region=\"per-page-filter\"]',\n        PAGINATE: '[data-action-paginate]',\n        NEXT: '[data-next]',\n        PREVIOUS: '[data-previous]',\n    };\n\n    /**\n     * Event listener for the display selector (\"Card\", \"List\", \"Summary\").\n     *\n     * @param {object} root The root element for the manage courses block\n     */\n    var registerManageCourseDisplayFilter = function(root) {\n        var manageCourseDisplayFilterContainer = $(root).find(SELECTORS.DISPLAY_FILTER);\n        CustomEvents.define(manageCourseDisplayFilterContainer, [CustomEvents.events.activate]);\n        manageCourseDisplayFilterContainer.on(\n            CustomEvents.events.activate,\n            SELECTORS.FILTER_OPTION,\n            function(e, data) {\n                data.originalEvent.preventDefault();\n\n                var option = $(e.target).closest(SELECTORS.FILTER_OPTION);\n\n                if (option.hasClass('active')) {\n                    // If it's already active then we don't need to do anything.\n                    return;\n                }\n\n                $(e.target).trigger(RemuiblckEvents.MANAGE_COURSES_DISPLAY_FILTER_CHANGE);\n                M.util.set_user_preference('managecourseview', option.data('value'));\n                ManageCoursesView.loadCourses(\n                    root,\n                    option.data('value'),\n                    getManageCoursesPerPage(root),\n                    $(root).find(SELECTORS.COURSES_LIST).data('currentpage')\n                );\n            }\n        );\n    };\n\n    /**\n     * Event listener for the per page selector\n     *\n     * @param {object} root The root element for the manage courses block\n     */\n    var registerManageCoursePerPageFilter = function(root) {\n        var manageCoursePerPageFilterContainer = $(root).find(SELECTORS.PER_PAGE_FILTER);\n        CustomEvents.define(manageCoursePerPageFilterContainer, [CustomEvents.events.activate]);\n        manageCoursePerPageFilterContainer.on(\n            CustomEvents.events.activate,\n            SELECTORS.FILTER_OPTION,\n            function(e, data) {\n                data.originalEvent.preventDefault();\n\n                var option = $(e.target).closest(SELECTORS.FILTER_OPTION);\n\n                if (option.hasClass('active')) {\n                    // If it's already active then we don't need to do anything.\n                    return;\n                }\n\n                $(e.target).trigger(RemuiblckEvents.MANAGE_COURSES_PAGE_FILTER_CHANGE);\n                M.util.set_user_preference('managecourseperpage', option.data('value'));\n                $(root).find(SELECTORS.COURSES_LIST).data('currentpage', 1);\n                ManageCoursesView.loadCourses(\n                    root,\n                    getManageCourseDisplay(root),\n                    option.data('value'),\n                    1\n                );\n            }\n        );\n    };\n\n    /**\n     * Event listener for the pagination controls\n     *\n     * @param {object} root The root element for the manage courses block\n     */\n    var registerManageCoursePageFilter = function(root) {\n        var manageCoursePageFilterContainer = $(root).find(SELECTORS.PAGINATE);\n        manageCoursePageFilterContainer.on(\n            'click',\n            function(e) {\n                var pagenumber = $(root).find(SELECTORS.COURSES_LIST).data('currentpage');\n                var maxpage = $(root).find(SELECTORS.COURSES_LIST).data('totalpages');\n                if ($(this).is(SELECTORS.NEXT)) {\n                    if (pagenumber == maxpage) {\n                        return;\n                    }\n                    pagenumber++;\n                } else if($(this).is(SELECTORS.PREVIOUS)) {\n                    if (pagenumber == 1) {\n                        return;\n                    }\n                    pagenumber--;\n                } else {\n                    return;\n                }\n                $(root).find(SELECTORS.COURSES_LIST).data('currentpage', pagenumber);\n                $(e.target).trigger(RemuiblckEvents.MANAGE_COURSES_PAGINATE);\n                ManageCoursesView.loadCourses(\n                    root,\n                    getManageCourseDisplay(root),\n                    getManageCoursesPerPage(root),\n                    pagenumber\n                );\n            }\n        );\n    };\n\n    /**\n     * Get manage courses display dropdown selection\n     * @param  {DOM}    root block DOM object\n     * @return {string}      selected duration option\n     */\n    var getManageCourseDisplay = function(root) {\n        return $(root).find(SELECTORS.DISPLAY_FILTER).find(SELECTORS.FILTER_OPTION + '.active').data('value');\n    };\n\n    /**\n     * Get manage courses filter dropdown selection\n     * @param  {DOM}    root block DOM object\n     * @return {string}      selected per page courses\n     */\n    var getManageCoursesPerPage = function(root) {\n        return $(root).find(SELECTORS.PER_PAGE_FILTER).find(SELECTORS.FILTER_OPTION + '.active').data('value');\n    };\n\n    /**\n     * Initialise manage courses filters events\n     * @param {DOM} root block DOM object\n     */\n    var init = function(root) {\n        registerManageCourseDisplayFilter(root);\n        registerManageCoursePerPageFilter(root);\n        registerManageCoursePageFilter(root);\n        ManageCoursesView.loadCourses(root, getManageCourseDisplay(root), getManageCoursesPerPage(root));\n    };\n    return {\n        init: init,\n        getManageCourseDisplay: getManageCourseDisplay\n    };\n});\n"],"file":"manage_courses_filters.min.js"}