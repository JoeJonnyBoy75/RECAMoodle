{"version":3,"sources":["../src/manage_courses_view.js"],"names":["define","$","ajax","Notification","Templates","SELECTORS","COURSES_LIST","COURSES_LIST_DECK","COURSE_MENU","PAGES","PROMISES","GET_MANAGE_COURSES_LIST","type","perpage","currentpage","call","methodname","args","TEMPLATES","MANAGE_COURSES_LIST","extraData","courses","enrollink","M","cfg","wwwroot","enroltitle","util","get_string","graderreportlink","graderreporttitle","activityreportlink","activityreporttitle","editcourselink","editcoursetitle","coursereporttitle","courseviewlink","applySlick","colors","each","index","element","length","css","not","slick","dots","arrows","infinite","rtl","attr","opacity","speed","slidesToShow","slidesToScroll","responsive","breakpoint","settings","window","trigger","initialiseEvents","init","root","loadCourses","arguments","done","response","find","data","totalcourses","totalpages","render","html","text","start","to","end","total","toolbar","content","position","style","event","hideOnClick","on","e","el","href","location","fail","exception"],"mappings":"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","sourcesContent":["/* eslint-disable babel/no-unused-expressions */\n/* eslint-disable no-self-assign */\n/* eslint-disable no-unused-vars */\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/notification',\n    'core/templates',\n    'block_remuiblck/slick',\n    'block_remuiblck/jquery-toolbar'\n], function(\n    $,\n    ajax,\n    Notification,\n    Templates,\n    toolbar\n) {\n    // Declair all required selectors\n    var SELECTORS = {\n        COURSES_LIST: '[data-region=\"manage-courses-list\"]',\n        COURSES_LIST_DECK: '#manage_courses .card-deck.dashboard-card-deck',\n        COURSE_MENU: '.coursemenubtn[data-region=\"managecourses\"]',\n        PAGES: '[data-region-pages]'\n    };\n\n    // Declair all required promises\n    var PROMISES = {\n        /**\n         * Get list of courses which user is enrolled as teacher\n         *\n         * @param {String} type        Type of view selected card|list|summary\n         * @param {Number} perpage     Number of courses per page\n         * @param {Number} currentpage Current page number\n         *\n         * @return {promise} Ajax promise call\n         */\n        GET_MANAGE_COURSES_LIST: function(type, perpage, currentpage) {\n            return ajax.call([{\n                methodname: 'block_remuiblck_get_manage_courses_list',\n                args: {\n                    type: type,\n                    perpage: perpage,\n                    currentpage: currentpage\n                }\n            }])[0];\n        }\n    };\n\n    // Declair all required templates\n    var TEMPLATES = {\n        MANAGE_COURSES_LIST: 'block_remuiblck/manage_courses_list_items'\n    };\n\n    /**\n     * Get extra data required for course list item\n     * @param  {array} courses courses array\n     * @return {array}         courses array with extra data\n     */\n    var extraData = function(courses) {\n        courses.enrollink = M.cfg.wwwroot + \"/user/index.php?id=\";\n        courses.enroltitle = M.util.get_string('enrolusers', 'core_enrol');\n\n        courses.graderreportlink = M.cfg.wwwroot + \"/grade/report/grader/index.php?id=\";\n        courses.graderreporttitle = M.util.get_string('graderreport', 'core_grades');\n\n        courses.activityreportlink = M.cfg.wwwroot + \"/report/outline/index.php?id=\";\n        courses.activityreporttitle = M.util.get_string('activityreport', 'moodle');\n\n        courses.editcourselink = M.cfg.wwwroot + \"/course/edit.php?id=\";\n        courses.editcoursetitle = M.util.get_string('editcourse', 'theme_remui');\n\n        courses.coursereporttitle = M.util.get_string('coursereport', 'moodle');\n\n        courses.courseviewlink = M.cfg.wwwroot + \"/course/view.php?id=\";\n        return courses;\n    };\n\n    /**\n     * Apply slick styling to courses list if user selects card view\n     * @param  {String} root Root element id\n     */\n    var applySlick = function(root) {\n        var colors = ['#f39f45', '#f95e5f', '#2fb0bf', '#2fb786', '#526069', '#46657d'];\n        $('#manage_courses .wdm-course-card-body').each(function(index, element) {\n            index >= colors.length ? index = index % colors.length : index = index;\n            $(element).css('background-color', colors[index]);\n        });\n        $('#manage_courses .dashboard-card-deck').css(\"overflow\", \"unset\");\n        $('#manage_courses .dashboard-card-deck').not('.slick-initialized').each(function(index, element) {\n            $(element).slick({\n                dots: false,\n                arrows: true,\n                infinite: false,\n                rtl: ($(\"html\").attr(\"dir\") == \"rtl\") ? true : false,\n                opacity: 0,\n                speed: 500,\n                slidesToShow: 3,\n                slidesToScroll: 3,\n                responsive: [{\n                    breakpoint: 1024,\n                    settings: {\n                        slidesToShow: 3,\n                        slidesToScroll: 3\n                    }\n                    }, {\n                    breakpoint: 800,\n                    settings: {\n                        slidesToShow: 2,\n                        slidesToScroll: 2\n                    }\n                    }, {\n                    breakpoint: 480,\n                    settings: {\n                        slidesToShow: 1,\n                        slidesToScroll: 1\n                    }\n                    }\n                ]\n            });\n            $(window).trigger('resize');\n        });\n    };\n\n    /**\n     * Load courses in course list view\n     * @param {String} root        Root element id\n     */\n    var loadCourses = function(root) {\n\n        var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'card';\n        var perpage = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 5;\n        var currentpage = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n\n\n        PROMISES.GET_MANAGE_COURSES_LIST(type, perpage, currentpage).done(function(response) {\n            if (response.courses.length != 0) {\n                response = extraData(response);\n                response[type] = true;\n                $(root).find(SELECTORS.COURSES_LIST).data('currentpage', currentpage);\n                $(root).find(SELECTORS.COURSES_LIST).data('totalcourses', response.totalcourses);\n                $(root).find(SELECTORS.COURSES_LIST).data('totalpages', response.totalpages);\n            }\n            Templates.render(TEMPLATES.MANAGE_COURSES_LIST, response).done(function(html) {\n                $(root).find(SELECTORS.COURSES_LIST).html(html).attr('data-type', type);\n                $(root).find(SELECTORS.PAGES).text(M.util.get_string('showingfromto', 'block_remuiblck', {\n                    start: response.start,\n                    to: response.end,\n                    total: response.totalcourses\n                }));\n                if (type == 'card') {\n                    applySlick(root);\n                }\n                $(root).find(SELECTORS.COURSES_LIST).find(SELECTORS.COURSE_MENU).each(function() {\n                    $(this).toolbar({\n                        content: $(this).data('toolbar'),\n                        position: 'bottom',\n                        style: 'primary',\n                        event: 'click',\n                        hideOnClick: true\n                    });\n                    // Fix redirect issue\n                    $(this).on('toolbarItemClick', function(e, el) {\n                        if (el.href) {\n                        window.location.href = el.href;\n                        }\n                    });\n                });\n            }).fail(Notification.exception);\n        }).fail(Notification.exception);\n    };\n\n    /**\n     * Initialize events\n     * @param  {String} root Root element id\n     */\n    var initialiseEvents = function(root) {\n        // Nothing to do here for now\n    };\n\n    /**\n     * Initialise manage courses view\n     * @param  {String} root Root element id\n     */\n    var init = function(root) {\n        initialiseEvents(root);\n    };\n    return {\n        init: init,\n        loadCourses: loadCourses\n    };\n});\n"],"file":"manage_courses_view.min.js"}