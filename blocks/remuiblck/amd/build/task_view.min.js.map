{"version":3,"sources":["../src/task_view.js"],"names":["define","$","ajax","Notification","Templates","SELECTORS","TASK_CONTAINER","PANEL","TASK_PROCESSING","TEMPLATES","TASK_LIST_ITEMS","PROMISES","GET_USER_TASKS","duration","status","search","call","methodname","args","loadTasks","root","arguments","length","done","response","tasks","no_tasks_image","M","util","image_url","output","render","html","find","toggleTaskProcessing","fail","ex","exception","show","parents","toggleClass","init"],"mappings":"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","sourcesContent":["/* eslint-disable camelcase */\n/* eslint-disable jsdoc/require-param */\n/* eslint-disable no-unused-vars */\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/notification',\n    'core/templates',\n    'core/modal_factory',\n    'core/modal_events',\n    'core/fragment',\n    'block_remuiblck/modal_task_popup',\n    'block_remuiblck/events'\n], function(\n    $,\n    ajax,\n    Notification,\n    Templates,\n    ModalFactory,\n    ModalEvents,\n    Fragment,\n    ModalTaskPopup,\n    RemuiblckEvents\n) {\n    var SELECTORS = {\n        TASK_CONTAINER: '[data-region=\"task-list\"]',\n        PANEL: '.panel',\n        TASK_PROCESSING: '.task-processing'\n    };\n    var TEMPLATES = {\n        TASK_LIST_ITEMS: 'block_remuiblck/task-list-items'\n    };\n    var PROMISES = {\n        /**\n         * Get user tasks promise call\n         * @param  {String} duration duration selection\n         * @param  {String} status   status selection\n         * @param  {String} search   status selection\n         * @return {String} ajax promise\n         */\n        GET_USER_TASKS: function(duration, status, search) {\n            return ajax.call([{\n                methodname : 'block_remuiblck_get_user_tasks',\n                args: {\n                    duration: duration,\n                    status: status,\n                    search: search\n                }\n            }])[0];\n        }\n    };\n\n    /**\n     * Load task in the tasks list\n     * @param {DOM} root object\n     */\n    var loadTasks = function(root) {\n\n        var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'today';\n        var status = arguments.length > 1 && arguments[2] !== undefined ? arguments[2] : 'all';\n        var search = arguments.length > 1 && arguments[3] !== undefined ? arguments[3] : '';\n\n        PROMISES.GET_USER_TASKS(duration, status, search).done(function(response) {\n            if (response.tasks.length == 0) {\n                response.no_tasks_image = M.util.image_url('empty_task_list', 'block_remuiblck');\n            }\n            var output = Templates.render(TEMPLATES.TASK_LIST_ITEMS, response);\n            output.done(function(html) {\n                $(root).find(SELECTORS.TASK_CONTAINER).html(html);\n                toggleTaskProcessing(root);\n            }).fail(function(ex) {\n                Notification.exception(ex);\n                toggleTaskProcessing(root);\n            });\n        }).fail(function(ex) {\n            Notification.exception(ex);\n            toggleTaskProcessing(root);\n        });\n    };\n\n    /**\n     * Load task on initialisation\n     * @param {DOM} root block DOM object\n     */\n    var init = function(root) {\n        loadTasks(root);\n    };\n\n    /**\n     * Toggle processing overlay to show that something happening in the background\n     * @param  {Dom} root\n     */\n    var toggleTaskProcessing = function(root) {\n        var show = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n        $(root).parents(SELECTORS.PANEL).find(SELECTORS.TASK_PROCESSING).toggleClass('show', show);\n    };\n    return {\n        init: init,\n        loadTasks: loadTasks,\n        toggleTaskProcessing: toggleTaskProcessing\n    };\n});\n"],"file":"task_view.min.js"}