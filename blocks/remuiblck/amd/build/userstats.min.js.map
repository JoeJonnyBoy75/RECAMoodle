{"version":3,"sources":["../src/userstats.js"],"names":["define","$","Ajax","myDoughnut","pieOptions","segmentShowStroke","segmentStrokeColor","segmentStrokeWidth","percentageInnerCutout","animationSteps","animateRotate","animateScale","responsive","maintainAspectRatio","legendTemplate","tooltipTemplate","legend","display","renderPieChart","response","destroy","pieChartCanvas","get","getContext","doughnutData","labels","datasets","data","backgroundColor","background_color","hoverBackgroundColor","hoverBackground_color","Chart","type","options","createpiechart","categoryId","call","methodname","args","categoryid","done","hide","show","empty","colors","each","index","value","append","fail","length","on"],"mappings":"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","sourcesContent":["/* eslint-disable no-undef */\n/* eslint-disable max-len */\n/* eslint-disable require-jsdoc */\ndefine(['jquery', 'core/ajax', 'core/chartjs'], function($, Ajax) {\n    var myDoughnut = null;\n    var legendtemplatestr1 = \"<ul class=\\\"<%=name.toLowerCase()%>-legend\\\"><% for (var i=0; i<segments.length; i++){%>\";\n    var legendtemplatestr2 = \"<span style=\\\"background-color:<%=segments[i].fillColor%>\\\"></span>\";\n    var legendtemplatestr3 = \"<%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>\";\n    var pieOptions = {\n        // Boolean - Whether we should show a stroke on each segment\n        segmentShowStroke: true,\n        // String - The colour of each segment stroke\n        segmentStrokeColor: \"#fff\",\n        // Number - The width of each segment stroke\n        segmentStrokeWidth: 1,\n        // Number - The percentage of the chart that we cut out of the middle\n        percentageInnerCutout: 50, // This is 0 for Pie charts\n        // Number - Amount of animation steps\n        animationSteps: 100,\n        // String - Animation easing effect\n        /* animation: {\n            duration: 2000,\n            easing: \"easeOutBounce\"\n        },*/\n        // Boolean - Whether we animate the rotation of the Doughnut\n        animateRotate: true,\n        // Boolean - Whether we animate scaling the Doughnut from the centre\n        animateScale: false,\n        // Boolean - whether to make the chart responsive to window resizing\n        responsive: true,\n        // Boolean - whether to maintain the starting aspect ratio or not when responsive,\n        // if set to false, will take up entire container\n        maintainAspectRatio: true,\n        // String - A legend template\n        legendTemplate: legendtemplatestr1 + legendtemplatestr2 + legendtemplatestr3,\n        // String - A tooltip template\n        tooltipTemplate: \"<%=value %> <%=label%> users\",\n\n        legend: {\n            display: false,\n        }\n    };\n\n    /**\n     * @param {String} response\n     */\n    function renderPieChart(response) {\n\n        if (myDoughnut !== null) {\n            myDoughnut.destroy();\n        }\n\n        var pieChartCanvas = $(\"#pieChartblock\").get(0).getContext(\"2d\");\n\n        var doughnutData = {\n            labels: response.labels,\n            datasets: [{\n                data: response.data,\n                backgroundColor: response.background_color,\n                hoverBackgroundColor: response.hoverBackground_color,\n            }]\n        };\n\n        myDoughnut = new Chart(pieChartCanvas, {type: 'doughnut', data: doughnutData, options: pieOptions});\n    }\n\n\n    /**\n     *\n     */\n    function createpiechart() {\n        var categoryId = $('#coursecategorylistblock option:selected').data('id');\n        Ajax.call([{\n            methodname: 'block_remuiblck_get_enrolled_users_by_category',\n            args: {\n                categoryid: categoryId\n            }\n        }])[0].done(function(response) {\n            if (response === null) {\n                $('canvas#pieChartblock').hide();\n                $('.enroll-stats-nouserserror').hide();\n                $('.chart-legend').hide();\n                $('.enroll-stats-error').show();\n            } else {\n                $('.enroll-stats-error').hide();\n                $('.enroll-stats-nouserserror').hide();\n                $('.chart-legend').show();\n                $('canvas#pieChartblock').show();\n\n                $('#enrolled_users_stats_block .chart-legend').empty();\n                var colors = ['#2196f3', '#00bcd4', '#009688', '#4caf50', '#8bc34a', '#ffeb3b', '#ff9800', '#f44336', '#9c27b0', '#673ab7', '#3f51b5'];\n                $.each(response.labels, function(index, value) {\n                    $('#enrolled_users_stats_block .chart-legend').append('<li class=\"list-group-item p-0 pt-1\">' + value + ': <span class=\"badge badge-round\" style=\"background-color:' + colors[index] + ';\">' + response.data[index] + '</span></li>');\n                });\n\n                renderPieChart(response);\n            }\n\n        }).fail(function() {\n            $('canvas#pieChartblock').hide();\n            $('.enroll-stats-error').show();\n        });\n    }\n\n    // Update pie chart on category selection\n    if ($('#enrolled_users_stats_block select').length) {\n        $('#enrolled_users_stats_block select#coursecategorylistblock').on('change', function() {\n            createpiechart();\n        });\n        createpiechart();\n    }\n    // ----------------------------------\n    // - END PIE CHART - DOUGHNUT\n    // ----------------------------------\n\n});\n"],"file":"userstats.min.js"}