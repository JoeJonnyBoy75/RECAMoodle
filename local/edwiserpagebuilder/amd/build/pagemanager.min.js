define("local_edwiserpagebuilder/pagemanager",["jquery","core/ajax","core/templates"],(function($,Ajax,Templates){let buttonAction="#epb_preview_window .actionbtn";const registerEvents=()=>{$(document).on("click","#epb_preview_window .cancel",(function(){var modalselector=$(this).attr("data-modal-id");$("#"+modalselector).remove()})),$(document).on("click","#epb_preview_window .expand-preview",(function(){$("#epb_preview_window .modal-body").removeClass("showtemplateform"),updateAction("usetemplate")})),$(document).on("click","#epb_preview_window .preview_image_container",(function(){$("#epb_preview_window .modal-body").removeClass("showtemplateform"),updateAction("usetemplate")})),$(document).on("click",buttonAction,(function(){switch($(this).attr("data-action")){case"usetemplate":$("#epb_preview_window .modal-body").addClass("showtemplateform"),initForm();break;case"update":if(validateForm()){1==confirm("Confirming this will override the configuration, continue?")&&performAction("update")}break;case"create":validateForm()&&performAction("create",!0)}})),$(document).on("change","#pagesselector",(function(){initForm()})),$(document).on("change","#fullscreenselector",(function(){$(buttonAction).removeAttr("disabled")})),$(document).on("keypress","#pagename",(function(){$(buttonAction).removeAttr("disabled")})),$(document).on("click","#pagelayout-tab.loadpagelayouts",(function(){Ajax.call([{methodname:"local_edwiserpagebuilder_render_page_cards",args:{},done:function(data){$(".addpage-modal-body").empty().append(data.html),$("#pagelayout-tab.loadpagelayouts").removeClass("loadpagelayouts")},fail:function(){}}])})),$(document).on("click",".btn-preview",(function(){Ajax.call([{methodname:"local_edwiserpagebuilder_fetch_page_details",args:{pageid:$(this).attr("data-page-id")},done:function(data){Templates.renderForPromise("local_edwiserpagebuilder/preview_window",JSON.parse(data)).then((_ref=>{let{html:html,js:js}=_ref;Templates.appendNodeContents("body",html,js),registerDynamicFormValidator()}))},fail:function(){console.log("We have error")}}])}))},initForm=()=>{var instid=$("#pagesselector").find(":selected").data("instid");null==instid||0==instid?updateAction("create"):updateAction("update",!0),$.each(jQuery("#pagesselector").find(":selected").data(),(function(i,v){$('[name="'+i+'"]').val(v)}))},updateAction=function(action){let disablebtn=arguments.length>1&&void 0!==arguments[1]&&arguments[1];$(buttonAction).attr("data-action",action),$(".actionbtnlabel.active").removeClass("active"),$('.actionbtnlabel[data-action="'+action+'"').addClass("active"),$(buttonAction).removeAttr("disabled"),disablebtn&&$(buttonAction).attr("disabled","disabled")},performAction=function(action){var arr=[];arr.action=action,$("#pageEditForm input, #pageEditForm select").each((function(index){var name=$(this).attr("name"),val=$(this).val();"pagelist"!==name&&(arr[name]=val)})),Ajax.call([{methodname:"local_edwiserpagebuilder_perform_page_action",args:Object.assign({},arr),done:function(response){},fail:function(){console.log("We have error")}}])},registerDynamicFormValidator=()=>{$(document).on("keyup",'#pagename[name="pagename"]',(function(){let empty=!1;$('#pagename[name="pagename"]').each((function(){empty=0==$(this).val().length})),empty?$(buttonAction).attr("disabled","disabled"):$(buttonAction).removeAttr("disabled")}))},validateForm=()=>{var text=$('#pagename[name="pagename"]').val();return""!==text&&null!=text||(alert("Page name should not be blank."),!1)};return{load:()=>{$(document).ready((function(){registerEvents()}))}}}));

//# sourceMappingURL=pagemanager.min.js.map