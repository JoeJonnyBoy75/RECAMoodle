define("local_edwiserpagebuilder/blockmanager",["jquery","core/ajax","core/templates"],(function($,Ajax,Templates){var refaddBlockModalUrl="";const load=()=>{$(document).ready((function(){let epbcustommodal=".epb_custom_modal.modal",layoutContainer=epbcustommodal+" .modal-body .addblock-modal-body.layout-list",blockContainer=epbcustommodal+" .modal-body .addblock-modal-body.blocks-list";function updateBlockContent(ele,islayout){$(ele).attr("disabled",!0),$(ele).find(".fa").removeClass("fa-download").addClass("fa-refresh rotate"),Ajax.call([{methodname:"edwiserpagebuilder_update_block_content",args:{blockname:$(ele).attr("data-blockname"),islayout:islayout},done:function(data){$(ele).find(".fa").removeClass("rotate"),0==data.status?updateButton(ele):$(ele).attr("disabled",!1)},fail:function(){$(ele).find(".fa").removeClass("rotate"),$(ele).attr("disabled",!1)}}])}function delete_content(id,islayout){Ajax.call([{methodname:"local_edwiserpagebuilder_delete_block",args:{id:id,islayout:islayout},done:function(data){if(islayout)var element=layoutContainer;else element=blockContainer;$(element).find('.data[data-blockid="'+id+'"]').remove()},fail:function(data){console.log("We are failure"),console.log(data)}}])}function updateButton(button){$(button).removeClass("btn-primary").addClass("btn-success"),$(button).find(".fa").removeClass("fa-refresh").addClass("fa-check"),jQuery(button).find("span").html("Updated")}$("#epbaddblockbutton").on("click",(function(){$(epbcustommodal).removeClass("d-none")})),$(document).on("click",".epb_custom_modal.modal .modal-content .show-layouts",(function(){$("#epb_custom_modal .modal-content").removeClass("blocklist").addClass("layoutlist")})),$(document).on("click",".epb_custom_modal.modal .modal-content .show-blocks",(function(){$("#epb_custom_modal .modal-content").removeClass("layoutlist").addClass("blocklist")})),$(document).on("click",".epb_custom_modal.modal .modal-body .addblock-modal-body.layout-list .islayout a",(function(e){e.preventDefault()})),$(document).on("click","#epbaddblockbutton",(function(){$(epbcustommodal).removeClass("d-none")})),$(".epb_custom_modal.modal .modal-content .close,.epb_custom_modal.modal .modal-content .cancel").on("click",(function(){$(epbcustommodal).addClass("d-none")})),$(document).on("click",".epb_custom_modal.modal .modal-content .blocks-list .card-header .update-content",(function(){updateBlockContent(this,!1)})),$(document).on("click",".epb_custom_modal.modal .modal-content .layout-list .card-header .update-content",(function(){updateBlockContent(this,!0)})),$(document).on("click",".epb_custom_modal.modal .modal-content .action-buttons-modal .updateblocklist",(function(){let _this=this;$(_this).attr("disabled",!0),$(_this).find(".fa").removeClass("fa-download").addClass("fa-refresh rotate");$(_this).next().val();Ajax.call([{methodname:"edwiserpagebuilder_fetch_blocks_list",args:{edwpageurl:refaddBlockModalUrl,contextid:M.cfg.contextid},done:function(data){$(_this).find(".fa").removeClass("rotate"),1==data.status?($(blockContainer+' [data-parentblock="edwiseradvancedblock"]').remove(),$(blockContainer+" .block-cards").prepend(data.html),updateButton(_this)):$(_this).attr("disabled",!1)},fail:function(){$(_this).find(".fa").removeClass("rotate"),$(_this).attr("disabled",!1)}}])})),$(document).on("click",".epb_custom_modal.modal .modal-content .action-buttons-modal .updatelayoutlist",(function(){let _this=this;$(_this).attr("disabled",!0),$(_this).find(".fa").removeClass("fa-download").addClass("fa-refresh rotate"),Ajax.call([{methodname:"edwiserpagebuilder_fetch_layout_list",args:{},done:function(data){$(_this).find(".fa").removeClass("rotate"),1==data.status?($(layoutContainer+" .block-cards").empty().prepend(data.html),updateButton(_this)):$(_this).attr("disabled",!1)},fail:function(){$(_this).find(".fa").removeClass("rotate"),$(_this).attr("disabled",!1)}}])})),$(document).on("click",".epb_custom_modal.modal .modal-body .addblock-modal-body.blocks-list .card .delete-content",(function(){delete_content($(this).data("blockid"),!1)})),$(document).on("click",".epb_custom_modal.modal .modal-body .addblock-modal-body.layout-list .card .delete-content",(function(){delete_content($(this).data("blockid"),!0)}))}))};return{load:function(addBlockModalUrl){refaddBlockModalUrl=addBlockModalUrl,load()}}}));

//# sourceMappingURL=blockmanager.min.js.map