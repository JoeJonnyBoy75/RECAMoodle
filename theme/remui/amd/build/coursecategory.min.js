"use strict";define(["jquery","theme_remui/bootstrap-select","core/templates","theme_remui/jquery-toolbar","core/ajax","core/str","core/notification"],function(e,t,a,r,n,i,s){var o,c,l=e("select#sortfilter.selectpicker"),d=e("#coursesearch2"),u=e("select#categoryfilter.selectpicker"),g=e("#coursestab"),p=e("#mycoursestab"),m=e("#coursesregion div.content"),h=e("#mycoursesregion div.content"),v=e("#coursespagination"),f=e("#mycoursespagination"),b=e(".togglebtn"),y="theme_remui/course_card_grid",w="theme_remui/course_card_list",_=".page-header-actionss";function C(){o.isFilterModified&&function(){e(".courses-tabs .courses-loader-wrap").show();var t=o.tab?h:m,r=o.tab?f:v;n.call([{methodname:"theme_remui_get_courses",args:{data:JSON.stringify(o)}}])[0].done(function(n){n=JSON.parse(n),e(_).empty(),1==n.hasmanagebutton&&e(_).append(n.managebuttons),null!=n.dropdown?e("#page-header .page-header-actionss").append(n.dropdown):e('#page-header .page-header-actionss [data-enhance="moodle-core-actionmenu"]').remove();var i=null===o.view?n.view:o.view,l="grid"==i||n.latest_card?y:w;(window.screen.width<=480||n.latest_card)&&(l=y,i="grid"),"grid"==i?(o.view="grid",e(".tab-content").addClass("grid-view").removeClass("list-view"),e(".grid_btn").addClass("btn-primary active"),e(".list_btn").removeClass("btn-primary active")):(o.view="list",e(".tab-content").addClass("list-view").removeClass("grid-view"),e(".grid_btn").removeClass("btn-primary active"),e(".list_btn").addClass("btn-primary active")),n.latest_card?(e(".tab-content").addClass("latest-cards"),e(".viewtoggler").addClass("hidden")):(e(".tab-content").removeClass("latest-cards"),e(".viewtoggler").removeClass("hidden"));var d=n.courses;if(d.length>0)for(var u=0;u<d.length;u++)a.render(l,d[u]).then(function(r,i){a.appendNodeContents(t,r,i),o.tab||n.latest_card||e(".showoptions").each(function(){e(this).toolbar({content:e(this).data("toolbar"),style:"primary"})})}).fail(s.exception);else{var g='<div class="alert alert-warning alert-dismissible  w-full mx-10" role="alert">';g+='<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">Ã—</span><span class="sr-only">Close</span></button>'+c[0]+"</div>",a.appendNodeContents(t,g,"")}o.pagination&&a.appendNodeContents(r,n.pagination,""),e(".courses-tabs .courses-loader-wrap").hide()}).fail(s.exception)}()}function k(){!function(){var t=o.tab?h:m;if(e(t).empty(),o.pagination){var a=o.tab?f:v;e(a).empty()}}(),C()}e(document).ready(function(){i.get_strings([{key:"nocoursefound",component:"theme_remui"}]).then(function(t){var a,r;c=t,(r={category:"all",sort:null,search:"",tab:!1,page:a={courses:0,mycourses:0},pagination:!0,view:null,isFilterModified:!0}).initAttributes=function(){r.category="all",r.sort=null,r.search="",r.tab=!1,r.page=a,r.pagination=!0,r.view=null,r.isFilterModified=!0},r.initPagination=function(){r.page={courses:0,mycourses:0}},o=r;for(var n,i=[],s=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),l=0;l<s.length;l++)n=s[l].split("="),i.push(n[0]),i[n[0]]=n[1];i.categoryid&&0!=i.categoryid&&(o.category=i.categoryid),null!=i.categorysort&&(o.sort=i.categorysort),null!=i.search&&(o.search=i.search),i.mycourses&&0!=i.mycourses&&(o.tab=!0,e("body").hasClass("notloggedin")&&(o.tab=!1)),function(t){e(".selectpicker").each(function(){e(this).selectpicker()}),"0"!==t.category&&e("#categoryfilter.selectpicker").selectpicker("val",t.category);null!==t.sort&&e("#sortfilter.selectpicker").selectpicker("val",t.sort);""!==t.sort&&e("#coursesearchbox").val(t.search);e(".category-filters").removeClass("d-none")}(o),C()})}),e(document).delegate(".tool-item","click",function(){window.location=e(this).attr("href")}),e(u).on("changed.bs.select",function(e){o.category=e.target.value,o.initPagination(),k()}),e(l).on("changed.bs.select",function(e){o.sort=e.target.value,k()}),e(g).on("click",function(){o.tab=!1,k()}),e(p).on("click",function(){o.tab=!0,k()}),e(d).on("submit",function(t){t.preventDefault(),o.initPagination(),o.search=e("#coursesearchbox").val(),k()}),e(b).on("click",function(){var t=e(this).attr("data-view");o.view=t,M.util.set_user_preference("course_view_state",t,null),k()}),e(document).delegate(".tab-pane .pagination .page-item .page-link","click",function(e){e.preventDefault();var t=e.target.href;void 0===t&&void 0===(t=e.target.parentElement.href)&&(t=e.target.parentElement.parentElement.href);for(var a,r=t.slice(t.indexOf("?")+1).split("&"),n=[],i=0;i<r.length;i++)a=r[i].split("="),n.push(a[0]),n[a[0]]=a[1];o.tab?o.page.mycourses=n.page:o.page.courses=n.page,k()})});
//# sourceMappingURL=coursecategory.min.js.map
