define("theme_remui/coursecategory",["jquery","core/ajax","core/str","core/templates","theme_remui/jquery-toolbar","core/notification","theme_remui/bootstrap-select"],(function($,Ajax,str,templates,toolbar,Notification){var filterobj,langstrings,categoryfilter=$("#categoryfilter"),sortfilter=$("select#sortfilter"),cardswrapperarea=$(".course-cards"),cardspagination=$(".cards-pagination"),gridtemplate="theme_remui/course_card_grid",searchfilter=$(".layout-1 .filters-wrapper .simplesearchform"),tagswrapper=($(".custom-switch"),$(".course-counter span.course-number"),$(".tag-wrapper")),togglebtn=$(".togglebtn"),courseContent=new function(){this.mycourses=!1,this.courses=!1,this.isLoaded=function(){return this[courseContent.getActive()]},this.loaded=function(state){void 0===state&&(state=!0),this[courseContent.getActive()]=state},this.reset=function(){this.mycourses=!1,this.courses=!1},this.getActive=function(){return!0===filterobj.tab?"mycourses":"courses"}};function updatePage(){$(cardswrapperarea).empty(),filterobj.pagination&&cardspagination.empty(),generateCourseCards()}function populate_tags(){Ajax.call([{methodname:"theme_remui_get_tags",args:{data:JSON.stringify(filterobj)}}])[0].done((function(response){tagswrapper.empty().append(response),generateHorizontalScroller($(".tag_list"))})).fail(Notification.exception)}const generateHorizontalScroller=element=>{if(0==element.length)return;const _main=element[0];if(_main.scrollWidth>_main.clientWidth){$(".left-scroll,.right-scroll").removeClass("d-none");const updateButtons=()=>{$(".left-scroll").disabled=!1,$(".right-scroll").disabled=!1,0==_main.scrollLeft&&($(".left-scroll").disabled=!0);var _scrollWidth=_main.scrollWidth,_clientWidth=_main.clientWidth;_main.scrollLeft==_scrollWidth-_clientWidth&&($(".left-scroll").disabled=!0)},moveRight=function(_ele){let scrollStep=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;_ele.scrollLeft+=scrollStep,updateButtons()},moveLeft=function(_ele){let scrollStep=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;_ele.scrollLeft-=scrollStep,updateButtons()};var _lInterval,_rInterval;$(".left-scroll").on("mouseover",(function(){_lInterval=setInterval((function(){console.log("We are executing continuousely"),moveLeft(_main,1)}),1)})),$(".right-scroll").on("mouseover",(function(){_rInterval=setInterval((function(){console.log("We are executing continuousely"),moveRight(_main,1)}),1)})),$(".left-scroll").on("mouseout",(function(){clearInterval(_lInterval)})),$(".right-scroll").on("mouseout",(function(){clearInterval(_rInterval)}))}};function generateCourseCards(){filterobj.isFilterModified&&function(){$(".courses-tabs .courses-loader-wrap").show();var serviceName="theme_remui_get_courses";Ajax.call([{methodname:serviceName,args:{data:JSON.stringify(filterobj)}}])[0].done((function(response){response=JSON.parse(response),$(".page-header-actionss").empty(),1==response.hasmanagebutton&&$(".page-header-actionss").append(response.managebuttons),null!=response.dropdown?$("#page-header .page-header-actionss").append(response.dropdown):$('#page-header .page-header-actionss [data-enhance="moodle-core-actionmenu"]').remove();var viewobj=void 0===filterobj.view?response.view:filterobj.view,rendertemplate="grid"==viewobj||response.latest_card?gridtemplate:"theme_remui/course_card_list";(window.screen.width<=480||response.latest_card)&&(rendertemplate=gridtemplate,viewobj="grid"),updateView(viewobj),response.latest_card?(cardswrapperarea.addClass("latest-cards"),$(".viewtoggler").addClass("hidden")):(cardswrapperarea.removeClass("latest-cards"),$(".viewtoggler").removeClass("hidden"));var courses=response.courses;if(courses.length>0)for(var i=0;i<courses.length;i++)templates.render(rendertemplate,courses[i]).then((function(html,js){templates.appendNodeContents(cardswrapperarea,html,js),filterobj.tab||response.latest_card||$(".showoptions").each((function(){$(this).toolbar({content:$(this).data("toolbar"),style:"primary"})}))})).fail(Notification.exception);else{var htmldata='<div class="alert alert-warning alert-dismissible  w-full mx-10" role="alert">';htmldata+='<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">Ã—</span><span class="sr-only">Close</span></button>'+langstrings[0]+"</div>",templates.appendNodeContents(cardswrapperarea,htmldata,"")}filterobj.pagination&&templates.appendNodeContents(cardspagination,response.pagination,""),$(".courses-tabs .courses-loader-wrap").hide()})).fail(Notification.exception)}()}function updateView(view){"grid"==view?(filterobj.view="grid",cardswrapperarea.addClass("grid-view").removeClass("list-view"),$(".grid_btn").addClass("btn-primary active"),$(".list_btn").removeClass("btn-primary active")):(filterobj.view="list",cardswrapperarea.addClass("list-view").removeClass("grid-view"),$(".grid_btn").removeClass("btn-primary active"),$(".list_btn").addClass("btn-primary active"))}$(document).delegate(".tool-item","click",(function(){window.location=$(this).attr("href")})),$(categoryfilter).on("change",(function(e){filterobj.category=e.target.value;var url=M.cfg.wwwroot+"/course/index.php?categoryid="+encodeURI(e.target.value);""!=filterobj.search&&(url+="&search="+filterobj.search),"default"!=filterobj.sort&&-1!=filterobj.sort&&"function"!=typeof filterobj.sort&&(url+="&sort="+filterobj.sort),window.history.replaceState("pagechange",document.title,url),window.location.reload()})),$(searchfilter).on("submit",(function(e){e.preventDefault(),e.stopPropagation(),filterobj.initPagination(),filterobj.search=$('.simplesearchform .input-group input[type="text"]').val(),courseContent.reset(),updatePage()})),$("#switch-label1, #switch-label2").on("change.bootstrapSwitch",(function(e,data){filterobj.tab=e.target.checked,updatePage(),populate_tags()})),$(togglebtn).on("click",(function(){var clckviewbtn=$(this).attr("data-view");filterobj.view=clckviewbtn,updateView(filterobj.view),M.util.set_user_preference("course_view_state",clckviewbtn,null),updatePage()})),$(sortfilter).on("changed.bs.select",(function(e){filterobj.sort=e.target.value,updatePage()})),$(document).delegate(".cards-pagination .pagination .page-item .page-link","click",(function(e){e.preventDefault();var linkdata=e.target.href;void 0===linkdata&&void 0===(linkdata=e.target.parentElement.href)&&(linkdata=e.target.parentElement.parentElement.href);for(var hash,hashes=linkdata.slice(linkdata.indexOf("?")+1).split("&"),vars=[],i=0;i<hashes.length;i++)hash=hashes[i].split("="),vars.push(hash[0]),vars[hash[0]]=hash[1];filterobj.tab?filterobj.page.mycourses=vars.page:filterobj.page.courses=vars.page,updatePage()}));return{init:function(defaultCategory){$("[category-filter-link]").on("click",(function(event){return event.preventDefault(),$(categoryfilter).val($(this).data("id")).trigger("change"),!1}));str.get_strings([{key:"nocoursefound",component:"theme_remui"}]).then((function(stringres){langstrings=stringres,filterobj=function(defaultCategory){var _pageobj={courses:0,mycourses:0},_obj={category:defaultCategory,sort:"ASC",search:"",tab:!1,page:_pageobj,pagination:!0,isFilterModified:!0,initAttributes:function(){_obj.category=defaultCategory,_obj.sort="ASC",_obj.search="",_obj.tab=!1,_obj.page=_pageobj,_obj.pagination=!0,_obj.isFilterModified=!0},initPagination:function(){_obj.page={courses:0,mycourses:0}}};return _obj}(defaultCategory);for(var hash,filterdata,vars=[],hashes=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<hashes.length;i++)hash=hashes[i].split("="),vars.push(hash[0]),vars[hash[0]]=hash[1];vars.categoryid&&0!=vars.categoryid&&(filterobj.category=vars.categoryid),null!=vars.sort&&(filterobj.sort=vars.sort),null!=vars.search&&(filterobj.search=decodeURI(vars.search)),filterdata=filterobj,$(".selectpicker").each((function(){$(this).selectpicker()})),""!==filterdata.category&&$("#categoryfilter.selectpicker").selectpicker("val",filterdata.category),1==filterdata.tab?$("#switch-label1, #switch-label2").prop("checked",!0):$("#switch-label1, #switch-label2").prop("checked",!1),null!==filterdata.sort&&null!=filterdata.sort&&"function"!=typeof filterdata.sort&&$("#sortfilter.selectpicker").selectpicker("val",filterdata.sort),""!==filterdata.search&&$(searchfilter).find('input[type="text"]').val(filterdata.search),$(".filters-wrapper").removeClass("d-none"),generateCourseCards(),populate_tags()}))}}}));

//# sourceMappingURL=coursecategory.min.js.map