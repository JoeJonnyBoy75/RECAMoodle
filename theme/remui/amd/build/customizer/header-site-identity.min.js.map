{"version":3,"file":"header-site-identity.min.js","sources":["../../src/customizer/header-site-identity.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n/**\n * Theme customizer header-site-identity js\n * @copyright (c) 2021 WisdmLabs (https://wisdmlabs.com/) <support@wisdmlabs.com>\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author    Yogesh Shirsath\n */\n\ndefine('theme_remui/customizer/header-site-identity', ['jquery', './utils'], function($, Utils) {\n\n    /**\n     * Selectors\n     */\n    var SELECTOR = {\n        BASE: 'header-site-identy',\n        IDENTITYPREFIX: 'header-site-identity',\n        LOGOORSITENAME: 'logoorsitename',\n        ICON: 'siteicon',\n        FONTSIZE: 'header-site-identity-fontsize',\n        LOGO: 'logo',\n        LOGOMINI: 'logomini',\n        BACKGROUNDCOLOR: 'header-background-color'\n    };\n\n    /**\n     * Handle site logo selector.\n     */\n    function logoSelectorHandler() {\n        $(`\n            [name='${SELECTOR.ICON}'],\n            [name='${SELECTOR.FONTSIZE}'],\n            [name='${SELECTOR.LOGO}'],\n            [name='${SELECTOR.LOGOMINI}'],\n            [name='${SELECTOR.BACKGROUNDCOLOR}']\n        `).closest('.setting-item').addClass('d-none');\n        switch ($(`[name='${SELECTOR.LOGOORSITENAME}']`).val()) {\n            case 'logo':\n                $(`\n                    [name='${SELECTOR.LOGO}']\n                `).closest('.setting-item').removeClass('d-none');\n                break;\n            case 'logomini':\n                $(`\n                    [name='${SELECTOR.LOGOMINI}']\n                `).closest('.setting-item').removeClass('d-none');\n                break;\n            case 'icononly':\n                $(`\n                    [name='${SELECTOR.ICON}'],\n                    [name='${SELECTOR.FONTSIZE}']\n                `).closest('.setting-item').removeClass('d-none');\n                break;\n            case 'iconsitename':\n                $(`\n                    [name='${SELECTOR.ICON}'],\n                    [name='${SELECTOR.FONTSIZE}']\n                `).closest('.setting-item').removeClass('d-none');\n                break;\n        }\n        let body = $(Utils.getDocument()).find('body');\n        body.removeClass(`\n            ${SELECTOR.IDENTITYPREFIX}-logo\n            ${SELECTOR.IDENTITYPREFIX}-logomini\n            ${SELECTOR.IDENTITYPREFIX}-icononly\n            ${SELECTOR.IDENTITYPREFIX}-iconsitename\n        `)\n        .addClass(SELECTOR.IDENTITYPREFIX + '-' + $(`[name='${SELECTOR.LOGOORSITENAME}']`).val());\n    }\n\n    /**\n     * Site logo handler.\n     */\n    function logoHandler() {\n        let body = $(Utils.getDocument()).find('body');\n\n        // Logo.\n        let itemid = $(`[name='${SELECTOR.LOGO}']`).val();\n        Utils.getFileURL(itemid).done(function(response) {\n            if (response == '') {\n                response = M.cfg.wwwroot + '/theme/remui/pix/logo.png';\n            }\n            $(body).find('.navbar .header-logo .navbar-brand-logo.logo').attr('src', response);\n            $(body).find('#page-footer .secondary-footer-logo').attr('src', response);\n        });\n\n        // Logo mini.\n        itemid = $(`[name='${SELECTOR.LOGOMINI}']`).val();\n        Utils.getFileURL(itemid).done(function(response) {\n            if (response == '') {\n                response = M.cfg.wwwroot + '/theme/remui/pix/logomini.png';\n            }\n            $(body).find('.navbar .header-logo .navbar-brand-logo.logomini').attr('src', response);\n        });\n    }\n\n    /**\n     * Site logo size handler.\n     */\n    function logoSizeHandler() {\n        let body = $(Utils.getDocument()).find('body');\n        let fontSize = $(`[name=\"${SELECTOR.FONTSIZE}\"]`).val();\n        $(body).find('.navbar .navbar-brand-logo').css('font-size', fontSize + 'rem');\n        let content = '';\n        // Tablet.\n        fontSize = $(`[name='${SELECTOR.FONTSIZE}-tablet']`).val();\n        if (fontSize != '') {\n            content += `\\n\n                @media screen and (min-width: ${Utils.deviceWidth.mobile + 1}px) and (max-width: ${Utils.deviceWidth.tablet}px) {\n                    .navbar .header-sitename .navbar-brand-logo {\n                        font-size: ${fontSize}rem !important;\n                    }\n                }\n            `;\n        }\n\n        Utils.putStyle(SELECTOR.BASE, content);\n    }\n\n    /**\n     * Apply settings.\n     */\n    function apply() {\n        logoSelectorHandler();\n        let icon = $(`[name=\"${SELECTOR.ICON}\"]`).val();\n        if (icon == '') {\n            icon = 'graduation-cap';\n        }\n        let body = $(Utils.getDocument()).find('body');\n        $(body).find('.navbar .header-sitename .navbar-brand-logo i').attr('class', 'fa fa-' + icon);\n        logoSizeHandler();\n        logoHandler();\n    }\n\n    /**\n     * Initialize evetns.\n     */\n    function init() {\n        // Logo mini listener.\n        Utils.fileObserver($(`[name='${SELECTOR.LOGO}']`).siblings('.filemanager')[0], logoHandler);\n\n        // Logo listener.\n        Utils.fileObserver($(`[name='${SELECTOR.LOGOMINI}']`).siblings('.filemanager')[0], logoHandler);\n\n        // Logo or sitename chooser listener.\n        $(`[name='${SELECTOR.LOGOORSITENAME}']`).on('change', function() {\n            logoSelectorHandler();\n        });\n\n        // Site icon listener.\n        $(`[name=\"${SELECTOR.ICON}\"]`).on('input', function() {\n            apply();\n        });\n\n        // Font size listener.\n        $(`\n            [name=\"${SELECTOR.FONTSIZE}\"],\n            [name=\"${SELECTOR.FONTSIZE}-tablet\"]\n        `).on('input', logoSizeHandler);\n    }\n\n    return {\n        init: init,\n        apply: apply\n    };\n});\n"],"names":["define","$","Utils","SELECTOR","logoSelectorHandler","closest","addClass","val","removeClass","getDocument","find","logoHandler","body","itemid","getFileURL","done","response","M","cfg","wwwroot","attr","logoSizeHandler","fontSize","css","content","deviceWidth","mobile","tablet","putStyle","apply","icon","init","fileObserver","siblings","on"],"mappings":";;;;;;AAqBAA,qDAAsD,CAAC,SAAU,YAAY,SAASC,EAAGC,WAKjFC,cACM,qBADNA,wBAEgB,uBAFhBA,wBAGgB,iBAHhBA,cAIM,WAJNA,kBAKU,gCALVA,cAMM,OANNA,kBAOU,WAPVA,yBAQiB,mCAMZC,6BACLH,iCACaE,iDACAA,qDACAA,iDACAA,qDACAA,0CACVE,QAAQ,iBAAiBC,SAAS,UAC7BL,mBAAYE,+BAA6BI,WACxC,OACDN,yCACaE,uCACVE,QAAQ,iBAAiBG,YAAY,oBAEvC,WACDP,yCACaE,2CACVE,QAAQ,iBAAiBG,YAAY,oBAEvC,eAMA,eACDP,yCACaE,yDACAA,2CACVE,QAAQ,iBAAiBG,YAAY,UAGrCP,EAAEC,MAAMO,eAAeC,KAAK,QAClCF,oCACCL,sDACAA,0DACAA,0DACAA,oDAELG,SAASH,wBAA0B,IAAMF,mBAAYE,+BAA6BI,gBAM9EI,kBACDC,KAAOX,EAAEC,MAAMO,eAAeC,KAAK,QAGnCG,OAASZ,mBAAYE,qBAAmBI,MAC5CL,MAAMY,WAAWD,QAAQE,MAAK,SAASC,UACnB,IAAZA,WACAA,SAAWC,EAAEC,IAAIC,QAAU,6BAE/BlB,EAAEW,MAAMF,KAAK,gDAAgDU,KAAK,MAAOJ,UACzEf,EAAEW,MAAMF,KAAK,uCAAuCU,KAAK,MAAOJ,aAIpEH,OAASZ,mBAAYE,yBAAuBI,MAC5CL,MAAMY,WAAWD,QAAQE,MAAK,SAASC,UACnB,IAAZA,WACAA,SAAWC,EAAEC,IAAIC,QAAU,iCAE/BlB,EAAEW,MAAMF,KAAK,oDAAoDU,KAAK,MAAOJ,sBAO5EK,sBACDT,KAAOX,EAAEC,MAAMO,eAAeC,KAAK,QACnCY,SAAWrB,mBAAYE,yBAAuBI,MAClDN,EAAEW,MAAMF,KAAK,8BAA8Ba,IAAI,YAAaD,SAAW,WACnEE,QAAU,GAEdF,SAAWrB,mBAAYE,gCAA8BI,MACrC,IAAZe,WACAE,qEACoCtB,MAAMuB,YAAYC,OAAS,iCAAwBxB,MAAMuB,YAAYE,+HAEhFL,qFAM7BpB,MAAM0B,SAASzB,cAAeqB,kBAMzBK,QACLzB,0BACI0B,KAAO7B,mBAAYE,qBAAmBI,MAC9B,IAARuB,OACAA,KAAO,sBAEPlB,KAAOX,EAAEC,MAAMO,eAAeC,KAAK,QACvCT,EAAEW,MAAMF,KAAK,iDAAiDU,KAAK,QAAS,SAAWU,MACvFT,kBACAV,oBA8BG,CACHoB,gBAvBA7B,MAAM8B,aAAa/B,mBAAYE,qBAAmB8B,SAAS,gBAAgB,GAAItB,aAG/ET,MAAM8B,aAAa/B,mBAAYE,yBAAuB8B,SAAS,gBAAgB,GAAItB,aAGnFV,mBAAYE,+BAA6B+B,GAAG,UAAU,WAClD9B,yBAIJH,mBAAYE,qBAAmB+B,GAAG,SAAS,WACvCL,WAIJ5B,iCACaE,qDACAA,0CACV+B,GAAG,QAASb,kBAKfQ,MAAOA"}