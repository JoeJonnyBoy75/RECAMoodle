{"version":3,"file":"global-colors.min.js","sources":["../../src/customizer/global-colors.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n/**\n * Theme customizer global-colors js\n * @copyright (c) 2021 WisdmLabs (https://wisdmlabs.com/) <support@wisdmlabs.com>\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author    Yogesh Shirsath\n */\n\ndefine('theme_remui/customizer/global-colors', ['jquery', './utils'], function($, Utils) {\n\n    var SELECTOR = {\n        SITECOLOR: 'sitecolorhex',\n        BACKGROUNDCHOOSE: 'global-colors-pagebackground',\n        BACKGROUNDCOLOR: 'global-colors-pagebackgroundcolor',\n        BACKGROUNDGRAD1: 'global-colors-pagebackgroundgradient1',\n        BACKGROUNDGRAD2: 'global-colors-pagebackgroundgradient2',\n        BACKGROUNDIMAGE: 'global-colors-pagebackgroundimage',\n        BACKGROUNDIMAGEATTACHMENT: 'global-colors-pagebackgroundimageattachment'\n    };\n\n    /**\n     * Get site color content.\n     * @returns {String}\n     */\n    function getSiteColorContent() {\n        let color = $(`[name='${SELECTOR.SITECOLOR}']`).spectrum('get').toString();\n        return `.collection thead th, .generaltable thead th, .navbar-brand, .nav-inverse, #page-footer,\n        .bg-primary, .btn-primary, .td.today, .drawer-right-toggle button,.drawer-left-toggle button, table.dataTable thead th,\n        table.dataTable tfoot th, .page-item.active .page-link {\n            background-color: ${color} !important;\n        }\n        .nav-tabs .nav-link.active, .btn-primary, .checkbox-custom input[type=checkbox]:checked+label::before,\n        .radio-custom input[type=radio]:checked+label::before, .page-item.active .page-link {\n            border-color: ${color} !important;\n        }' +\n        .text-primary, .nav-tabs .nav-link.active, .nav-tabs .nav-link.active .fa, [data-region=\"drawer\"]:not(.dark)\n        .list-group-item.active, [data-region=\"drawer\"]:not(.dark) .list-group-item.active .icon {\n            color: ${color} !important;\n        }`;\n    }\n\n    /**\n     * Handle background color.\n     */\n    function handleBackground() {\n        let color, color1, color2, itemid, attachment;\n        $(`\n            [name='${SELECTOR.BACKGROUNDCOLOR}'],\n            [name='${SELECTOR.BACKGROUNDGRAD1}'],\n            [name='${SELECTOR.BACKGROUNDGRAD2}'],\n            [name='${SELECTOR.BACKGROUNDIMAGE}'],\n            [name='${SELECTOR.BACKGROUNDIMAGEATTACHMENT}']\n        `).closest('.setting-item').addClass('d-none');\n        switch ($(`[name='${SELECTOR.BACKGROUNDCHOOSE}']`).val()) {\n            case 'color':\n                $(`[name='${SELECTOR.BACKGROUNDCOLOR}']`).closest('.setting-item').removeClass('d-none');\n                color = $(`[name='${SELECTOR.BACKGROUNDCOLOR}']`).spectrum('get').toString();\n                Utils.putStyle(SELECTOR.BACKGROUNDCHOOSE, `\n                    #page {\n                        background-color: ${color};\n                    }\n                `);\n                break;\n            case 'gradient':\n                $(`\n                    [name='${SELECTOR.BACKGROUNDGRAD1}'],\n                    [name='${SELECTOR.BACKGROUNDGRAD2}']\n                `).closest('.setting-item').removeClass('d-none');\n                color1 = $(`[name='${SELECTOR.BACKGROUNDGRAD1}']`).spectrum('get').toString();\n                color2 = $(`[name='${SELECTOR.BACKGROUNDGRAD2}']`).spectrum('get').toString();\n                Utils.putStyle(SELECTOR.BACKGROUNDCHOOSE, `\n                    #page {\n                        background: linear-gradient(100deg, ${color1}, ${color2});\n                    }\n                `);\n                break;\n            case 'image':\n                $(`\n                    [name='${SELECTOR.BACKGROUNDIMAGE}'],\n                    [name='${SELECTOR.BACKGROUNDIMAGEATTACHMENT}']\n                `).closest('.setting-item').removeClass('d-none');\n                itemid = $(`[name='${SELECTOR.BACKGROUNDIMAGE}']`).val();\n                attachment = $(`[name='${SELECTOR.BACKGROUNDIMAGEATTACHMENT}']`).val();\n                Utils.getFileURL(itemid).done(function(response) {\n                    if (response == '') {\n                        response = M.cfg.wwwroot + '/theme/remui/pix/placeholder.png';\n                    }\n\n                    Utils.putStyle(SELECTOR.BACKGROUNDCHOOSE, `\n                        #page {\n                            background: url('${response}');\n                            background-attachment: ${attachment};\n                            background-position: top;\n                            background-size: ${attachment == 'fixed' ? 'cover' : 'auto'};\n                        }\n                    `);\n                });\n                break;\n        }\n    }\n\n    /**\n     * Apply settings.\n     */\n    function apply() {\n        Utils.putStyle(SELECTOR.SITECOLOR, getSiteColorContent());\n        handleBackground();\n    }\n\n    /**\n     * Initialize events.\n     */\n    function init() {\n        // Site color.\n        $(`\n            [name='${SELECTOR.SITECOLOR}']\n        `).bind('color.changed', function() {\n            apply();\n        });\n\n        $(`\n            [name='${SELECTOR.BACKGROUNDCOLOR}'],\n            [name='${SELECTOR.BACKGROUNDGRAD1}'],\n            [name='${SELECTOR.BACKGROUNDGRAD2}']\n        `).on('color.changed', function() {\n            handleBackground();\n        });\n\n        // Navbar inverse.\n        $(`\n            [name='${SELECTOR.BACKGROUNDCHOOSE}'],\n            [name='${SELECTOR.BACKGROUNDIMAGEATTACHMENT}']\n        `).on('input', function() {\n            handleBackground();\n        });\n\n        // Background image observer.\n        Utils.fileObserver($(`[name='${SELECTOR.BACKGROUNDIMAGE}']`).siblings('.filemanager')[0], handleBackground);\n    }\n\n    return {\n        init: init,\n        apply: apply\n    };\n});\n"],"names":["define","$","Utils","SELECTOR","handleBackground","color","color1","color2","itemid","attachment","closest","addClass","val","removeClass","spectrum","toString","putStyle","getFileURL","done","response","M","cfg","wwwroot","apply","getSiteColorContent","init","bind","on","fileObserver","siblings"],"mappings":";;;;;;AAqBAA,8CAA+C,CAAC,SAAU,YAAY,SAASC,EAAGC,WAE1EC,mBACW,eADXA,0BAEkB,+BAFlBA,yBAGiB,oCAHjBA,yBAIiB,wCAJjBA,yBAKiB,wCALjBA,yBAMiB,oCANjBA,mCAO2B,uDA2BtBC,uBACDC,MAAOC,OAAQC,OAAQC,OAAQC,kBACnCR,iCACaE,4DACAA,4DACAA,4DACAA,4DACAA,oDACVO,QAAQ,iBAAiBC,SAAS,UAC7BV,mBAAYE,iCAA+BS,WAC1C,QACDX,mBAAYE,gCAA8BO,QAAQ,iBAAiBG,YAAY,UAC/ER,MAAQJ,mBAAYE,gCAA8BW,SAAS,OAAOC,WAClEb,MAAMc,SAASb,6GAEaE,+DAI3B,WACDJ,yCACaE,oEACAA,kDACVO,QAAQ,iBAAiBG,YAAY,UACxCP,OAASL,mBAAYE,gCAA8BW,SAAS,OAAOC,WACnER,OAASN,mBAAYE,gCAA8BW,SAAS,OAAOC,WACnEb,MAAMc,SAASb,+HAE+BG,oBAAWC,iEAIxD,QACDN,yCACaE,oEACAA,4DACVO,QAAQ,iBAAiBG,YAAY,UACxCL,OAASP,mBAAYE,gCAA8BS,MACnDH,WAAaR,mBAAYE,0CAAwCS,MACjEV,MAAMe,WAAWT,QAAQU,MAAK,SAASC,UACnB,IAAZA,WACAA,SAAWC,EAAEC,IAAIC,QAAU,oCAG/BpB,MAAMc,SAASb,oHAEYgB,4EACMV,6HAEQ,SAAdA,WAAwB,QAAU,2EAWpEc,QACLrB,MAAMc,SAASb,kCAhFXE,MAAQJ,mBAAYE,0BAAwBW,SAAS,OAAOC,sVAIxCV,mRAIJA,2RAIPA,iCAoEsBmB,IACnCpB,yBAkCG,CACHqB,gBA3BAxB,iCACaE,oCACVuB,KAAK,iBAAiB,WACrBH,WAGJtB,iCACaE,4DACAA,4DACAA,0CACVwB,GAAG,iBAAiB,WACnBvB,sBAIJH,iCACaE,6DACAA,oDACVwB,GAAG,SAAS,WACXvB,sBAIJF,MAAM0B,aAAa3B,mBAAYE,gCAA8B0B,SAAS,gBAAgB,GAAIzB,mBAK1FmB,MAAOA"}