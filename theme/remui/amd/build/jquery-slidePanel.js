!function(t,e){if("function"==typeof define&&define.amd)define(["jquery"],e);else if("undefined"!=typeof exports)e(require("jquery"));else{e(t.jQuery),t.jquerySlidePanelEs={}}}(this,function(t){"use strict";var e,d=(e=t)&&e.__esModule?e:{default:e};function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t};function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(){return void 0!==window.performance&&window.performance.now?window.performance.now():Date.now()}var s={skin:null,classes:{base:"slidePanel",show:"slidePanel-show",loading:"slidePanel-loading",content:"slidePanel-content",dragging:"slidePanel-dragging",willClose:"slidePanel-will-close"},closeSelector:null,template:function(t){return'<div class="'+t.classes.base+" "+t.classes.base+"-"+t.direction+'"><div class="'+t.classes.content+'"></div></div>'},loading:{appendTo:"panel",template:function(t){return'<div class="'+t.classes.loading+'"></div>'},showCallback:function(t){this.$el.addClass(t.classes.loading+"-show")},hideCallback:function(t){this.$el.removeClass(t.classes.loading+"-show")}},contentFilter:function(t,e){return t},useCssTransforms3d:!0,useCssTransforms:!0,useCssTransitions:!0,dragTolerance:150,mouseDragHandler:null,mouseDrag:!0,touchDrag:!0,pointerDrag:!0,direction:"right",duration:"500",easing:"ease",beforeLoad:$.noop,afterLoad:$.noop,beforeShow:$.noop,afterShow:$.noop,onChange:$.noop,beforeHide:$.noop,afterHide:$.noop,beforeDrag:$.noop,afterDrag:$.noop},a=(n(r,[{key:"initialize",value:function(t){var e=(arguments.length<=1?void 0:arguments[1])||{};if("string"==typeof t)t={url:t};else if(t&&1===t.nodeType){var n=(0,d.default)(t);t={url:n.attr("href"),settings:n.data("settings")||{},options:n.data()||{}}}return t&&t.options?t.options=d.default.extend(!0,e,t.options):t.options=e,t.options=d.default.extend(!0,{},s,t.options),d.default.extend(this,t),this}}]),r);function r(t){o(this,r);for(var e=arguments.length,n=Array(1<e?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.initialize.apply(this,[t].concat(n))}var l,u,h,f,p,g,v,m,w,y={};function _(t){return w(t,!0)}function b(r,e,l,n){function u(t,e){return 1-3*e+3*t}function h(t,e){return 3*e-6*t}function d(t){return 3*t}function c(t,e,n){return((u(e,n)*t+h(e,n))*t+d(e))*t}return r===e&&l===n?{css:"linear",fn:function(t){return t}}:{css:"cubic-bezier("+r+","+e+","+l+","+n+")",fn:function(t){return c(function(t){for(var e,n,i,o=t,s=0;s<4;++s){var a=(e=o,3*u(n=r,i=l)*e*e+2*h(n,i)*e+d(n));if(0===a)return o;o-=(c(o,r,l)-t)/a}return o}(t),e,n)}}}l=y,u={transition:{end:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"}},animation:{end:{WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd",animation:"animationend"}}},h=["webkit","Moz","O","ms"],f=(0,d.default)("<support>").get(0).style,p=function(){return Boolean(w("transform"))},g=function(){return Boolean(w("perspective"))},v=function(){return Boolean(w("transition"))},m=function(){return Boolean(w("animation"))},w=function(t,e){var n=!1,i=t.charAt(0).toUpperCase()+t.slice(1);return void 0!==f[t]&&(n=t),n||d.default.each(h,function(t,e){return void 0===f[e+i]||(n="-"+e.toLowerCase()+"-"+i,!1)}),e?n:!!n},v()&&(l.transition=new String(_("transition")),l.transition.end=u.transition.end[l.transition]),m()&&(l.animation=new String(_("animation")),l.animation.end=u.animation.end[l.animation]),p()&&(l.transform=new String(_("transform")),l.transform3d=g()),"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch?l.touch=!0:l.touch=!1,window.PointerEvent||window.MSPointerEvent?l.pointer=!0:l.pointer=!1,l.prefixPointerEvent=function(t){return window.MSPointerEvent?"MSPointer"+t.charAt(9).toUpperCase()+t.substr(10):t};var k={ease:b(.25,.1,.25,1),linear:b(0,0,1,1),"ease-in":b(.42,0,1,1),"ease-out":b(0,0,.58,1),"ease-in-out":b(.42,0,.58,1)},P={prepareTransition:function(t,e,n,i,o){var s=[];e&&s.push(e),n&&(d.default.isNumeric(n)&&(n+="ms"),s.push(n)),i?s.push(i):s.push(this.easing.css),o&&s.push(o),t.css(y.transition,s.join(" "))},do:function(o,t,s){A.enter("animating");var e=o.options.duration,a=o.options.easing||"ease",r=this,n=o.makePositionStyle(t),i=null;for(i in n)if({}.hasOwnProperty.call(n,i))break;if(o.options.useCssTransitions&&y.transition)setTimeout(function(){r.prepareTransition(o.$panel,i,e,a)},20),o.$panel.one(y.transition.end,function(){d.default.isFunction(s)&&s(),o.$panel.css(y.transition,""),A.leave("animating")}),setTimeout(function(){o.setPosition(t)},20);else{var l=c(),u=o.getPosition(),h=t;r._frameId=window.requestAnimationFrame(function t(e){var n=(e-l)/o.options.duration;1<n&&(n=1),n=k[a].fn(n);var i=parseFloat(u+n*(h-u),10);o.setPosition(i),1===n?(window.cancelAnimationFrame(r._frameId),r._frameId=null,d.default.isFunction(s)&&s(),A.leave("animating")):r._frameId=window.requestAnimationFrame(t)})}}},D=(n(C,[{key:"initialize",value:function(t){this._view=t,this.build()}},{key:"build",value:function(){if(!this._builded){var t=this._view.options,e=t.loading.template.call(this,t);switch(this.$el=(0,d.default)(e),t.loading.appendTo){case"panel":this.$el.appendTo(this._view.$panel);break;case"body":this.$el.appendTo("body");break;default:this.$el.appendTo(t.loading.appendTo)}this._builded=!0}}},{key:"show",value:function(t){this.build();var e=this._view.options;e.loading.showCallback.call(this,e),d.default.isFunction(t)&&t.call(this)}},{key:"hide",value:function(t){var e=this._view.options;e.loading.hideCallback.call(this,e),d.default.isFunction(t)&&t.call(this)}}]),C);function C(t){o(this,C),this.initialize(t)}var x=(n(T,[{key:"initialize",value:function(t){this._view=t,this.options=t.options,this._drag={time:null,pointer:null},this.bindEvents()}},{key:"bindEvents",value:function(){var t=this._view.$panel,e=this.options;e.mouseDrag&&(t.on(A.eventName("mousedown"),d.default.proxy(this.onDragStart,this)),t.on(A.eventName("dragstart selectstart"),function(t){if(!e.mouseDragHandler||(0,d.default)(t.target).is(e.mouseDragHandler)||0<(0,d.default)(t.target).parents(e.mouseDragHandler).length)return!1})),e.touchDrag&&y.touch&&(t.on(A.eventName("touchstart"),d.default.proxy(this.onDragStart,this)),t.on(A.eventName("touchcancel"),d.default.proxy(this.onDragEnd,this))),e.pointerDrag&&y.pointer&&(t.on(A.eventName(y.prefixPointerEvent("pointerdown")),d.default.proxy(this.onDragStart,this)),t.on(A.eventName(y.prefixPointerEvent("pointercancel")),d.default.proxy(this.onDragEnd,this)))}},{key:"onDragStart",value:function(t){var e=this;if(3!==t.which){var n=this.options;this._view.$panel.addClass(this.options.classes.dragging),this._position=this._view.getPosition(!0),this._drag.time=(new Date).getTime(),this._drag.pointer=this.pointer(t);var i=function(){A.enter("dragging"),A.trigger(e._view,"beforeDrag")};if(n.mouseDrag){if(n.mouseDragHandler&&!((0,d.default)(t.target).is(n.mouseDragHandler)||0<(0,d.default)(t.target).parents(n.mouseDragHandler).length))return;(0,d.default)(document).on(A.eventName("mouseup"),d.default.proxy(this.onDragEnd,this)),(0,d.default)(document).one(A.eventName("mousemove"),d.default.proxy(function(){(0,d.default)(document).on(A.eventName("mousemove"),d.default.proxy(this.onDragMove,this)),i()},this))}n.touchDrag&&y.touch&&((0,d.default)(document).on(A.eventName("touchend"),d.default.proxy(this.onDragEnd,this)),(0,d.default)(document).one(A.eventName("touchmove"),d.default.proxy(function(){(0,d.default)(document).on(A.eventName("touchmove"),d.default.proxy(this.onDragMove,this)),i()},this))),n.pointerDrag&&y.pointer&&((0,d.default)(document).on(A.eventName(y.prefixPointerEvent("pointerup")),d.default.proxy(this.onDragEnd,this)),(0,d.default)(document).one(A.eventName(y.prefixPointerEvent("pointermove")),d.default.proxy(function(){(0,d.default)(document).on(A.eventName(y.prefixPointerEvent("pointermove")),d.default.proxy(this.onDragMove,this)),i()},this))),(0,d.default)(document).on(A.eventName("blur"),d.default.proxy(this.onDragEnd,this)),t.preventDefault()}}},{key:"onDragMove",value:function(t){var e=this.distance(this._drag.pointer,this.pointer(t));A.is("dragging")&&(Math.abs(e)>this.options.dragTolerance?!0!==this._willClose&&(this._willClose=!0,this._view.$panel.addClass(this.options.classes.willClose)):!1!==this._willClose&&(this._willClose=!1,this._view.$panel.removeClass(this.options.classes.willClose)),A.is("dragging")&&(t.preventDefault(),this.move(e)))}},{key:"onDragEnd",value:function(t){var e=this.distance(this._drag.pointer,this.pointer(t));(0,d.default)(document).off(A.eventName("mousemove mouseup touchmove touchend pointermove pointerup MSPointerMove MSPointerUp blur")),this._view.$panel.removeClass(this.options.classes.dragging),!0===this._willClose&&(this._willClose=!1,this._view.$panel.removeClass(this.options.classes.willClose)),A.is("dragging")&&(A.leave("dragging"),A.trigger(this._view,"afterDrag"),Math.abs(e)<this.options.dragTolerance?this._view.revert():this._view.hide())}},{key:"pointer",value:function(t){var e={x:null,y:null};return(t=(t=t.originalEvent||t||window.event).touches&&t.touches.length?t.touches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t).pageX?(e.x=t.pageX,e.y=t.pageY):(e.x=t.clientX,e.y=t.clientY),e}},{key:"distance",value:function(t,e){var n=this.options.direction;return"left"===n||"right"===n?e.x-t.x:e.y-t.y}},{key:"move",value:function(t){var e=this._position+t;if("right"===this.options.direction||"bottom"===this.options.direction){if(e<0)return}else if(0<e)return;this.options.useCssTransforms||this.options.useCssTransforms3d||"right"!==this.options.direction&&"bottom"!==this.options.direction||(e=-e),this._view.setPosition(e+"px")}}]),T);function T(){o(this,T),this.initialize.apply(this,arguments)}var F=(n(S,[{key:"initialize",value:function(t){this.options=t,this._instance=null,this._showed=!1,this._isLoading=!1,this.build()}},{key:"setLength",value:function(){switch(this.options.direction){case"top":case"bottom":this._length=this.$panel.outerHeight();break;case"left":case"right":this._length=this.$panel.outerWidth()}}},{key:"build",value:function(){if(!this._builded){var t=this.options,e=t.template.call(this,t),n=this;this.$panel=(0,d.default)(e).appendTo("body"),t.skin&&this.$panel.addClass(t.skin),this.$content=this.$panel.find("."+this.options.classes.content),t.closeSelector&&this.$panel.on("click touchstart",t.closeSelector,function(){return n.hide(),!1}),this.loading=new D(this),this.setLength(),this.setPosition(this.getHidePosition()),(t.mouseDrag||t.touchDrag||t.pointerDrag)&&(this.drag=new x(this)),this._builded=!0}}},{key:"getHidePosition",value:function(){var t=this.options;if(t.useCssTransforms||t.useCssTransforms3d)switch(t.direction){case"top":case"left":return"-100";case"bottom":case"right":return"100"}switch(t.direction){case"top":case"bottom":return parseFloat(-this._length/(0,d.default)(window).height()*100,10);case"left":case"right":return parseFloat(-this._length/(0,d.default)(window).width()*100,10)}}},{key:"empty",value:function(){this._instance=null,this.$content.empty()}},{key:"load",value:function(e){var n=this,i=e.options;function o(t){t=i.contentFilter.call(this,t,e),n.$content.html(t),n.hideLoading(),n._instance=e,A.trigger(n,"afterLoad",e)}A.trigger(this,"beforeLoad",e),this.empty(),e.content?o(e.content):e.url?(this.showLoading(),d.default.ajax(e.url,e.settings||{}).done(function(t){o(t)})):o("")}},{key:"showLoading",value:function(){var t=this;this.loading.show(function(){t._isLoading=!0})}},{key:"hideLoading",value:function(){var t=this;this.loading.hide(function(){t._isLoading=!1})}},{key:"show",value:function(t){this.build(),A.enter("show"),A.trigger(this,"beforeShow"),(0,d.default)("html").addClass(this.options.classes.base+"-html"),this.$panel.addClass(this.options.classes.show);var e=this;P.do(this,0,function(){e._showed=!0,A.trigger(e,"afterShow"),d.default.isFunction(t)&&t.call(e)})}},{key:"change",value:function(t){A.trigger(this,"beforeShow"),A.trigger(this,"onChange",t,this._instance),this.load(t),A.trigger(this,"afterShow")}},{key:"revert",value:function(t){var e=this;P.do(this,0,function(){d.default.isFunction(t)&&t.call(e)})}},{key:"hide",value:function(t){A.leave("show"),A.trigger(this,"beforeHide");var e=this;P.do(this,this.getHidePosition(),function(){e.$panel.removeClass(e.options.classes.show),e._showed=!1,e._instance=null,A._current===e&&(A._current=null),A.is("show")||(0,d.default)("html").removeClass(e.options.classes.base+"-html"),d.default.isFunction(t)&&t.call(e),A.trigger(e,"afterHide")})}},{key:"makePositionStyle",value:function(t){var e=void 0,n="0",i="0";(function(t){return"string"==typeof t&&-1!==t.indexOf("%")})(t)||function(t){return"string"==typeof t&&-1!==t.indexOf("px")}(t)||(t+="%"),this.options.useCssTransforms&&y.transform?("left"===this.options.direction||"right"===this.options.direction?n=t:i=t,e=y.transform.toString(),t=this.options.useCssTransforms3d&&y.transform3d?"translate3d("+n+","+i+",0)":"translate("+n+","+i+")"):e=this.options.direction;var o={};return o[e]=t,o}},{key:"getPosition",value:function(t){var e=void 0;if(this.options.useCssTransforms&&y.transform){if(!(e=function(t){return!(!t||"matrix"!==t.substr(0,6))&&t.replace(/^.*\((.*)\)$/g,"$1").replace(/px/g,"").split(/, +/)}(this.$panel.css(y.transform))))return 0;e="left"===this.options.direction||"right"===this.options.direction?e[12]||e[4]:e[13]||e[5]}else e=this.$panel.css(this.options.direction),e=parseFloat(e.replace("px",""));return!0!==t&&(e=e/this._length*100),parseFloat(e,10)}},{key:"setPosition",value:function(t){var e=this.makePositionStyle(t);this.$panel.css(e)}}]),S);function S(t){o(this,S),this.initialize(t)}var A={_states:{},_views:{},_current:null,is:function(t){return this._states[t]&&0<this._states[t]},enter:function(t){void 0===this._states[t]&&(this._states[t]=0),this._states[t]++},leave:function(t){this._states[t]--},trigger:function(t,e){for(var n=arguments.length,i=Array(2<n?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];var s=[t].concat(i);(0,d.default)(document).trigger("slidePanel::"+e,s),d.default.isFunction(t.options[e])&&t.options[e].apply(t,i)},eventName:function(t){if("string"!=typeof t||""===t)return".slidepanel";for(var e=(t=t.split(" ")).length,n=0;n<e;n++)t[n]=t[n]+".slidepanel";return t.join(" ")},show:function(t,e){var n=this;if(!(t instanceof a))switch(arguments.length){case 0:t=new a;break;case 1:t=new a(t);break;case 2:t=new a(t,e)}function i(){o.show(),o.load(t),n._current=o}var o=this.getView(t.options);null!==this._current?o===this._current?this._current.change(t):this._current.hide(i):i()},getView:function(t){var e=function(t){"string"!=typeof t&&(t=JSON.stringify(t));var e,n=0,i=void 0;if(0===t.length)return n;for(i=0,e=t.length;i<e;i++)n=(n<<5)-n+t.charCodeAt(i),n|=0;return n}(t);return this._views.hasOwnProperty(e)?this._views[e]:this._views[e]=new F(t)},hide:function(t){void 0!==t&&void 0!==t.options?this.getView(t.options).hide():null!==this._current&&this._current.hide()}},E={is:function(t){return A.is(t)},show:function(t,e){return A.show(t,e),this},hide:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return A.hide(e),this}};Date.now||(Date.now=function(){return(new Date).getTime()});for(var N=["webkit","moz"],M=0;M<N.length&&!window.requestAnimationFrame;++M){var H=N[M];window.requestAnimationFrame=window[H+"RequestAnimationFrame"],window.cancelAnimationFrame=window[H+"CancelAnimationFrame"]||window[H+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS (6|7|8)/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var L=0;window.requestAnimationFrame=function(t){var e=c(),n=Math.max(L+16,e);return setTimeout(function(){t(L=n)},n-e)},window.cancelAnimationFrame=clearTimeout}function z(t){for(var e=arguments.length,n=Array(1<e?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var o=t;return"string"==typeof t?this.each(function(){var t=d.default.data(this,"slidePanel");switch(t instanceof a||(t=new a(this,n),d.default.data(this,"slidePanel",t)),o){case"hide":A.hide(t);break;case"show":A.show(t)}}):this.each(function(){d.default.data(this,"slidePanel")||(d.default.data(this,"slidePanel",new a(this,t)),(0,d.default)(this).on("click",function(t){var e=d.default.data(this,"slidePanel");A.show(e),t.preventDefault(),t.stopPropagation()}))})}var q=d.default.fn.slidePanel;d.default.fn.slidePanel=z,d.default.slidePanel=function(){A.show.apply(A,arguments)},d.default.extend(d.default.slidePanel,{setDefaults:function(t){d.default.extend(!0,s,d.default.isPlainObject(t)&&t)},noConflict:function(){return d.default.fn.slidePanel=q,z}},{version:"0.3.5"},E)});