define("theme_remui/customizer",["jquery","core/ajax","core/notification","core/modal_factory","core/modal_events","./customizer/utils","./customizer/global-site","./customizer/global-body","./customizer/global-colors","./customizer/global-heading","./customizer/global-buttons","./customizer/header-site-identity","./customizer/header-primary","./customizer/header-menu","./customizer/footer","./customizer/additional-settings","./customizer/forms-settings","./customizer/icon-settings","core/modal_save_cancel"],(function($,Ajax,Notification,ModalFactory,ModalEvents,Utils,globalSite,globalBody,globalColors,globalHeading,globalButtons,headerSiteIdentity,headerPrimary,headerMenu,footer,additionalSettings,formssettings,iconsettings){var PROMISES_SAVE_SETTINGS=function(settings){return Ajax.call([{methodname:"theme_remui_customizer_save_settings",args:{settings:settings}}])[0]},SELECTOR_CUSTOMIZER="#customizer",SELECTOR_CONTROLS="#customize-controls",SELECTOR_MODE_TOGGLE="#customize-controls .mode-toggle",SELECTOR_CLOSE_CUSTOMIZER=".customize-controls-close",SELECTOR_CUSTMIZER_TOGGLE=".customizer-controls-toggle",SELECTOR_PUBLISH="#publish-settings",SELECTOR_IFRAME="#customizer-frame",SELECTOR_MAIN_OVERLAY="#main-overlay",SELECTOR_PANEL_LINK="[sidebar-panel-link]",SELECTOR_PANEL_BACK=".customize-panel-back",SELECTOR_PANEL=".sidebar-panel",SELECTOR_PANEL_ID="panel-id",SELECTOR_CURRENT="current",SELECTOR_SETTINGS_RESET="#reset-settings",SELECTOR_INPUT_RESET=".input-reset",SELECTOR_SELECT_RESET=".select-reset",SELECTOR_CHECKBOX_RESET=".checkbox-reset",SELECTOR_COLOR_RESET=".color-reset",SELECTOR_TEXTAREA_RESET=".textarea-reset",SELECTOR_HTMLEDITOR_RESET=".htmleditor-reset",SELECTOR_HEADING_TOGGLE=".heading-toggle",SELECTOR_RANGEINPUT=".form-range";function initHandlers(){globalSite.init(),globalBody.init(),globalColors.init(),globalHeading.init(),globalButtons.init(),headerSiteIdentity.init(),headerPrimary.init(),headerMenu.init(),footer.init(),additionalSettings.init(),formssettings.init(),iconsettings.init(),$(document).trigger("edwiser.customizer.init")}function applySettings(){globalSite.apply(),globalBody.apply(),globalColors.apply(),globalHeading.apply(),globalButtons.apply(),headerSiteIdentity.apply(),headerPrimary.apply(),headerMenu.apply(),footer.apply(),additionalSettings.apply(),formssettings.apply(),iconsettings.apply(),$(document).trigger("edwiser.customizer.apply")}return{init:function(){1!=window["customizer-enabled"]&&(window["customizer-enabled"]=!0,$(document).ready((function($){initHandlers(),$(SELECTOR_IFRAME).on("load",(function(){$(Utils.getDocument()).find("body").addClass("customizer-opened"),$(Utils.getDocument()).find(".customizer-editing-icon").closest("a").addClass("d-none").removeClass("d-flex"),$(Utils.getDocument()).find("#sidebar-setting").addClass("d-none"),$(document).trigger("remui-adjust-left-side");var contentWindow=this.contentWindow;setTimeout((function(){window.history.replaceState("pagechange",document.title,M.cfg.wwwroot+"/theme/remui/customizer.php?url="+encodeURI(contentWindow.location.href)),$(SELECTOR_CLOSE_CUSTOMIZER).attr("href",contentWindow.location.href),applySettings(),Utils.hideLoader(),contentWindow.onbeforeunload=function(){Utils.showLoader()}}),10)})),$(SELECTOR_SETTINGS_RESET).on("click",(function(){let settings=$(SELECTOR_CONTROLS).serializeArray();for(var customcss="",i=settings.length-1;i>0;i--)if("customcss"==settings[i].name){customcss=settings[i];break}ModalFactory.create({title:M.util.get_string("reset","moodle"),body:M.util.get_string("reset-settings-description","theme_remui"),type:ModalFactory.types.SAVE_CANCEL},$("#create")).done((function(modal){modal.show(),modal.setSaveButtonText(M.util.get_string("yes","moodle")),modal.getRoot().on(ModalEvents.save,(function(){$(SELECTOR_MAIN_OVERLAY).removeClass("d-none"),PROMISES_SAVE_SETTINGS(JSON.stringify([customcss])).done((function(){location.reload()})).fail((function(ex){Notification.exception(ex),$(SELECTOR_MAIN_OVERLAY).addClass("d-none")}))}))}))})),$(SELECTOR_PANEL_LINK).on("click",(function(){$(SELECTOR_PANEL+"#"+$(this).data(SELECTOR_PANEL_ID)).addClass(SELECTOR_CURRENT),$(this).closest(SELECTOR_PANEL).removeClass(SELECTOR_CURRENT)})),$(SELECTOR_PANEL_BACK).on("click",(function(){$(SELECTOR_PANEL+":not("+SELECTOR_PANEL+"#"+$(this).data(SELECTOR_PANEL_ID)+")").removeClass(SELECTOR_CURRENT),$(SELECTOR_PANEL+"#"+$(this).data(SELECTOR_PANEL_ID)).addClass(SELECTOR_CURRENT)})),$(SELECTOR_MODE_TOGGLE).on("click",(function(){$(SELECTOR_CUSTOMIZER).removeClass("mode-desktop mode-tablet mode-mobile").addClass("mode-".concat($(this).data("mode")))})),$(SELECTOR_CONTROLS).on("submit",(function(event){return event.preventDefault(),!1})),$("\n                ".concat(SELECTOR_CONTROLS,' input[type="text"],\n                ').concat(SELECTOR_CONTROLS,' input[type="number"],\n                ').concat(SELECTOR_CONTROLS,' input[type="checkbox"]\n                ').concat(SELECTOR_CONTROLS," textarea,\n                ").concat(SELECTOR_CONTROLS," select\n            ")).on("change",(function(){$(SELECTOR_CONTROLS).data("unsaved",!0)})),$("".concat(SELECTOR_CONTROLS,' input[type="color"]')).on("color.changed",(function(){$(SELECTOR_CONTROLS).data("unsaved",!0)})),$(SELECTOR_PUBLISH).on("click",(function(){$(SELECTOR_MAIN_OVERLAY).removeClass("d-none");let settings=$(SELECTOR_CONTROLS).serializeArray();settings.forEach((function(element,index){$('[name="'.concat(element.name,'"]')).is(".site-colorpicker")&&(element.value=$('[name="'.concat(element.name,'"]')).spectrum("get").toString(),settings[index]=element)})),PROMISES_SAVE_SETTINGS(JSON.stringify(settings)).done((function(response){let obj={type:ModalFactory.types.ALERT};0==response.status?(obj.title=M.util.get_string("error","theme_remui"),obj.body=response.errors):(obj.title=M.util.get_string("success","moodle"),obj.body=response.message,$(SELECTOR_CONTROLS).data("unsaved",!1)),ModalFactory.create(obj,$("#create")).done((function(modal){modal.show(),$(SELECTOR_MAIN_OVERLAY).addClass("d-none")}))})).fail(Notification.exception)})),$(SELECTOR_CLOSE_CUSTOMIZER).on("click",(function(event){return 0==$(SELECTOR_CONTROLS).data("unsaved")||(event.preventDefault(),ModalFactory.create({title:M.util.get_string("customizer-close-heading","theme_remui"),body:M.util.get_string("customizer-close-description","theme_remui"),type:ModalFactory.types.SAVE_CANCEL},$("#create")).done((function(modal){modal.show(),modal.setSaveButtonText(M.util.get_string("yes","moodle")),modal.getRoot().on(ModalEvents.save,(function(){window.location=$(SELECTOR_CLOSE_CUSTOMIZER).attr("href")}))}))),!0})),$(SELECTOR_CUSTMIZER_TOGGLE).on("click",(function(){$("body").toggleClass("full-customizer")})),$(SELECTOR_COLOR_RESET).on("click",(function(){let color=$(this).data("default");$(this).next().find("input").spectrum("set",color),$(this).next().find("input").trigger("color.changed",color)})),$(SELECTOR_CHECKBOX_RESET).on("click",(function(){let value=$(this).data("default");$(this).next().find("input").prop("checked",$(this).next().find("input").val()==value),$(this).next().find("input").trigger("change").trigger("input")})),$(SELECTOR_SELECT_RESET).on("click",(function(){let value=$(this).data("default");$(this).next().find("select").val(value).trigger("input").trigger("change")})),$(SELECTOR_INPUT_RESET).on("click",(function(){let value=$(this).data("default");$(this).next().find("input").val(value).trigger("input").trigger("change")})),$(SELECTOR_TEXTAREA_RESET).on("click",(function(){let value=$(this).data("default");$(this).next().find("textarea").val(value).trigger("input").trigger("change")})),$(SELECTOR_HTMLEDITOR_RESET).on("click",(function(){let value=$(this).data("default"),textarea=$(this).next().find("textarea");$(this).next().find("#".concat(textarea.attr("id"),"editable")).html(value),textarea.val(value).trigger("input").trigger("change")})),$(SELECTOR_HEADING_TOGGLE).on("click",(function(){$(this).next().slideToggle("fast")})),$("body").on("input",SELECTOR_RANGEINPUT,(function(){let id=$(this).attr("id"),value=$(this).val();$("#".concat(id,"-range-value")).text(value)}))})))}}}));

//# sourceMappingURL=customizer.min.js.map