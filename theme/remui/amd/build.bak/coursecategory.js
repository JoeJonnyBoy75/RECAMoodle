"use strict";define(["jquery","theme_remui/bootstrap-select","core/templates","theme_remui/jquery-toolbar","core/ajax"],function(e,t,a,s,r){var n,i=e("select#sortfilter.selectpicker"),o=(e(".togglebtn"),e("#coursesearch2")),c=e("select#categoryfilter.selectpicker"),l=(e(".nav-tabs .nav-item"),e("#coursestab")),u=e("#mycoursestab"),d=e("#coursesregion div.content"),g=e("#mycoursesregion div.content"),p=e("#coursespagination"),v=e("#mycoursespagination"),b=e(".togglebtn"),f="theme_remui/course_card_grid",m="theme_remui/course_card_list",h=".page-header-actionss";function y(){n.isFilterModified&&function(){$(".courses-tabs .courses-loader-wrap").show();var t=n.tab?g:d,s=n.tab?v:p;r.call([{methodname:"theme_remui_get_courses",args:{data:JSON.stringify(n)}}])[0].done(function(r){r=JSON.parse(r),e(h).empty(),1==r.hasmanagebutton&&e(h).append(r.managebuttons);var i=null==n.view?r.view:n.view,o="grid"==i||r.latest_card?f:m;(window.screen.width<=480||r.latest_card)&&(o=f,i="grid"),"grid"==i?(n.view="grid",e(".tab-content").addClass("grid-view").removeClass("list-view"),e(".grid_btn").addClass("btn-primary active"),e(".list_btn").removeClass("btn-primary active")):(n.view="list",e(".tab-content").addClass("list-view").removeClass("grid-view"),e(".grid_btn").removeClass("btn-primary active"),e(".list_btn").addClass("btn-primary active")),r.latest_card?(e(".tab-content").addClass("latest-cards"),e(".viewtoggler").addClass("hidden")):(e(".tab-content").removeClass("latest-cards"),e(".viewtoggler").removeClass("hidden"));var c=r.courses;if(c.length>0)for(var l=0;l<c.length;l++)a.render(o,c[l]).then(function(s,i){a.appendNodeContents(t,s,i),n.tab||r.latest_card||e(".showoptions").each(function(){e(this).toolbar({content:e(this).data("toolbar"),style:"primary"})})}).fail(function(e){});else{'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button> No Courses Found</div>',a.appendNodeContents(t,'<div class="alert alert-warning alert-dismissible  w-full mx-10" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button> No Courses Found</div>',"")}n.pagination&&a.appendNodeContents(s,r.pagination,""),e(".courses-tabs .courses-loader-wrap").hide()}).fail(function(t){e(".courses-tabs .courses-loader-wrap").show()})}()}function w(){var e={courses:0,mycourses:0},t={category:"all",sort:null,search:"",tab:!1,page:e,pagination:!0,view:null,isFilterModified:!0,initAttributes:function(){t.category="all",t.sort=null,t.search="",t.tab=!1,t.page=e,t.pagination=!0,t.view=null,t.isFilterModified=!0},initPagination:function(){t.page={courses:0,mycourses:0}}};return t}function C(){!function(){var t=n.tab?g:d;if(e(t).empty(),n.pagination){var a=n.tab?v:p;e(a).empty()}}(),y()}e(document).ready(function(){n=new w;for(var t,a=[],s=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),r=0;r<s.length;r++)t=s[r].split("="),a.push(t[0]),a[t[0]]=t[1];a.categoryid&&0!=a.categoryid&&(n.category=a.categoryid),null!=a.categorysort&&(n.sort=a.categorysort),null!=a.search&&(n.search=a.search),a.mycourses&&0!=a.mycourses&&(n.tab=!0,$("body").hasClass("notloggedin")&&(n.tab=!1)),function(t){e(".selectpicker").each(function(){e(this).selectpicker()}),"0"!=t.category&&e("#categoryfilter.selectpicker").selectpicker("val",t.category);null!=t.sort&&e("#sortfilter.selectpicker").selectpicker("val",t.sort);""!=t.sort&&e("#coursesearchbox").val(t.search);e(".category-filters").removeClass("d-none")}(n),y()}),e(document).delegate(".tool-item","click",function(){window.location=e(this).attr("href")}),e(c).on("changed.bs.select",function(e){n.category=e.target.value,n.initPagination(),C()}),e(i).on("changed.bs.select",function(e){n.sort=e.target.value,C()}),e(l).on("click",function(){n.tab=!1,C()}),e(u).on("click",function(){n.tab=!0,C()}),e(o).on("submit",function(t){t.preventDefault(),n.initPagination(),n.search=e("#coursesearchbox").val(),C()}),e(b).on("click",function(){var t=e(this).attr("data-view");n.view=t,M.util.set_user_preference("course_view_state",t,null),C()}),e(document).delegate(".tab-pane .pagination .page-item .page-link","click",function(e){e.preventDefault();var t=e.target.href;void 0===t&&void 0===(t=e.target.parentElement.href)&&(t=e.target.parentElement.parentElement.href);for(var a,s=t.slice(t.indexOf("?")+1).split("&"),r=[],i=0;i<s.length;i++)a=s[i].split("="),r.push(a[0]),r[a[0]]=a[1];n.tab?n.page.mycourses=r.page:n.page.courses=r.page,C()})});