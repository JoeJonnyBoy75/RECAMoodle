"use strict";define(["jquery","core/custom_interaction_events","core/notification","core/pubsub","core/paged_content_paging_bar","core/templates","core_course/events","core_course/repository","theme_remui/slick"],function(n,e,i,t,o,s,r,c){var d={CARD_CONTAINER:'[data-region="card-deck"]',COURSE_IS_FAVOURITE:'[data-region="is-favourite"]',CONTENT:'[data-region="view-content"]',EMPTY_MESSAGE:'[data-region="empty-message"]',LOADING_PLACEHOLDER:'[data-region="loading-placeholder"]'},a=!1,u=[],l=function(e){return c.getLastAccessedCourses(e,10).then(function(e){return function(e){var t=e.map(function(n){return s.render("block_recentlyaccessedcourses/course-card",n)});return n.when.apply(null,t).then(function(){var e=[];return t.forEach(function(t){t.then(function(i){e.push(n(i))}).catch(i.exception)}),e})}(e)})},f=function(e){var i=e.find(d.CONTENT).find(d.CARD_CONTAINER);!function(n){var e=n.find(d.PAGING_BAR);e.css("opacity",0),e.css("visibility","hidden"),e.attr("aria-hidden","true")}(e),i.is(".slick-initialized")&&i.slick("unslick"),i.html(u),i.slick({dots:!1,arrows:!0,infinite:!1,rtl:"rtl"==n("html").attr("dir"),opacity:0,speed:500,slidesToShow:4,slidesToScroll:4,responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:800,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}]})},h=function(e){var i=null,o=!1;t.subscribe(r.favourited,function(n){!function(n,e){u.forEach(function(n){n.attr("data-course-id")==e&&n.find(d.COURSE_IS_FAVOURITE).removeClass("hidden")})}(0,n)}),t.subscribe(r.unfavorited,function(n){!function(n,e){u.forEach(function(n){n.attr("data-course-id")==e&&n.find(d.COURSE_IS_FAVOURITE).addClass("hidden")})}(0,n)}),t.subscribe("nav-drawer-toggle-start",function(){if(a&&u.length&&!o){o=!0;var n=0;!function i(){setTimeout(function(){f(e),++n<5&&o&&i()},100)}()}}),t.subscribe("nav-drawer-toggle-end",function(){o=!1}),n(window).on("resize",function(){a&&u.length&&(i||(i=setTimeout(function(){i=null,f(e)},66)))})};return{init:function(e,t){t=n(t),h(t),l(e).then(function(n){a=!0,(u=n).length?(function(n){n.find(d.CONTENT).removeClass("hidden"),n.find(d.EMPTY_MESSAGE).addClass("hidden"),n.find(d.LOADING_PLACEHOLDER).addClass("hidden")}(t),f(t)):function(n){n.find(d.EMPTY_MESSAGE).removeClass("hidden"),n.find(d.LOADING_PLACEHOLDER).addClass("hidden"),n.find(d.CONTENT).addClass("hidden")}(t)}).catch(i.exception)}}});